<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh_Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="My blog">
<meta property="og:url" content="http://wu-yuanyi.github.io/index.html">
<meta property="og:site_name" content="My blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://wu-yuanyi.github.io/"/>





  <title>My blog</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh_Hans">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">My blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Über
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            Kategorien
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/09/13/SAS编程演义8-10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/13/SAS编程演义8-10/" itemprop="url">《SAS编程演义》笔记（8-10章）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-13T17:43:19+08:00">
                2017-09-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="菱花荇蔓随双桨：百变绘图"><a href="#菱花荇蔓随双桨：百变绘图" class="headerlink" title="菱花荇蔓随双桨：百变绘图"></a>菱花荇蔓随双桨：百变绘图</h2><h2 id="拙中藏巧混天成：统计表格"><a href="#拙中藏巧混天成：统计表格" class="headerlink" title="拙中藏巧混天成：统计表格"></a>拙中藏巧混天成：统计表格</h2><h2 id="一缕檀烟万佛名：宏中奥秘"><a href="#一缕檀烟万佛名：宏中奥秘" class="headerlink" title="一缕檀烟万佛名：宏中奥秘"></a>一缕檀烟万佛名：宏中奥秘</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/09/13/SAS编程演义5-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/13/SAS编程演义5-7/" itemprop="url">《SAS编程演义》笔记（5-7章）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-13T13:31:21+08:00">
                2017-09-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="亦应帷幄运鸿筹：数据库集"><a href="#亦应帷幄运鸿筹：数据库集" class="headerlink" title="亦应帷幄运鸿筹：数据库集"></a>亦应帷幄运鸿筹：数据库集</h2><h3 id="修改数据集"><a href="#修改数据集" class="headerlink" title="修改数据集"></a>修改数据集</h3><p><strong>MODIFY</strong> <em>master-data-set</em> &lt;(<em>data-set-options</em>)&gt; <em>transaction-data-set</em> &lt;(<em>data-set-options</em>)&gt; &lt;CUROBS=<em>variable</em>&gt; &lt; NOBS=<em>variable</em>&gt; &lt;END=<em>variable</em>&gt; &lt;UPDATEMODE=MISSINGCHECK|NOMISSINGCHECK&gt;;</p>
<p><strong>BY</strong> <em>by-variable</em>;</p>
<ul>
<li><em>master-data-set</em>：主数据集（Master Dataset），存放原始数据。</li>
<li><em>transaction-data-set</em>：事物数据集（Transaction Dataset），存放匹配变量、需要修改的变量及其新值。</li>
<li>CUROBS=<em>variable</em>：将当前生成的数据集观测存储到临时变量variable中</li>
<li>NOBS=<em>variable</em>：将主数据集和事物数据集总观测数存储到临时变量variable中</li>
<li>END=<em>variable</em>：创建并命名一个临时变量variable，用1和0标记是否为最后一条记录。</li>
</ul>
<p><strong>MODIFY</strong> <em>master-data-set</em> &lt;(<em>data-set-options</em>)&gt; KEY=<em>index</em> &lt;/UNIQUE&gt; &lt;KEYRESET=<em>variable</em>&gt; &lt;NOBS=<em>variable</em>&gt; &lt;END=<em>variable</em>&gt;;</p>
<ul>
<li>KEY=<em>index</em>：指定索引</li>
<li>KEYRESET=<em>variable</em>：是否从索引头部查找</li>
</ul>
<p><strong>MODIFY</strong> <em>master-data-set</em> &lt;(<em>data-set-options</em>)&gt; &lt;NOBS=variable&gt; POINT=<em>variable</em>;</p>
<ul>
<li>POINT=<em>variable</em>：随机读取由variable指定的观测</li>
</ul>
<p><strong>MODIFY</strong> <em>master-data-set</em> &lt;(<em>data-set-options</em>)&gt; &lt;NOBS=<em>variable</em>&gt; &lt;END=<em>variable</em>&gt;</p>
<p>MODIFY比SET更高效。MODIFY语句直接修改原数据集，不生成新数据集。SET语句打开原数据集，重新生成一份新数据集（即使新数据集与原数据集同名）。因此使用MODIFY语句时，DATA语句后必须是原数据集，但使用SET语句时则无所谓。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data class;</div><div class="line">    set sashelp.class;</div><div class="line">    weight = weight*0.4536; /*lbs-&gt;kg*/</div><div class="line">    height = height*0.0254; /*in-&gt;m*/</div><div class="line">run;</div><div class="line"></div><div class="line">data sashelp.class;</div><div class="line">    modify sashelp.class;</div><div class="line">    weight = weight*0.4536; /*lbs-&gt;kg*/</div><div class="line">    height = height*0.0254; /*in-&gt;m*/</div><div class="line">run;</div></pre></td></tr></table></figure>
<p>MODIFY比MERGE更高效。MODIFY语句进行匹配修改观测时，因其采用动态WHERE语句，不像MERGE需要事先排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">data raw;/*主数据集*/</div><div class="line">    name=&quot;吴源燚&quot;;gender=&quot;&quot;;age=2;Location=&quot;SH&quot;;output;</div><div class="line">    name=&quot;WUYY&quot;;gender=&quot;M&quot;;age=.;Location=&quot;SH&quot;;output;</div><div class="line">run;</div><div class="line"></div><div class="line">data new;/*事物数据集*/</div><div class="line">    name=&quot;吴源燚&quot;;gender=&quot;M&quot;;</div><div class="line">    name=&quot;WUYY&quot;;age=25;output;</div><div class="line">    name=&quot;WUYY&quot;;age=30;output;</div><div class="line">run;</div><div class="line"></div><div class="line">data raw;</div><div class="line">    modify raw new;</div><div class="line">    by name;</div><div class="line">    replace; /*默认可省略*/</div><div class="line">run;</div></pre></td></tr></table></figure>
<p>MODIFY语句是对原数据集里观测进行修改，但是不能改变数据集结构，即不能新增变量也不能新增观察。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data sashelp.class class_female;</div><div class="line">    modify sashelp.class;</div><div class="line">    if sex =&quot;F&quot; then do;</div><div class="line">        output class_female;</div><div class="line">        remove sashelp.class;</div><div class="line">    end;</div><div class="line">    else do;</div><div class="line">        height=height+5;</div><div class="line">        replace sashelp.class;</div><div class="line">    end;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="更新数据集"><a href="#更新数据集" class="headerlink" title="更新数据集"></a>更新数据集</h3><p><strong>UPDATE</strong> <em>master-data-set</em> &lt;(<em>data-set-options</em>)&gt; <em>transaction-data-set</em> &lt;(<em>data-set-options</em>)&gt; &lt;END=<em>variable</em>&gt; &lt;UPDATEMODE=MISSINGCHECK|NOMISSINGCHECK&gt;;</p>
<p><strong>BY</strong> <em>by-variable</em>;</p>
<ul>
<li><em>master-data-set</em>：主数据集，存放原始数据。</li>
<li><em>transaction-data-set</em>：事物数据集，存放匹配变量、需要修改的变量及其新值。</li>
<li>END=<em>variable</em>：创建并命名一个临时变量variable，用1和0标记是否为最后一条记录。</li>
<li>UPDATEMODE：是否用事物数据集里的缺失值更新主数据集<ul>
<li>是：NOMISSINGCHECK</li>
<li>否：MISSINGCHECK</li>
</ul>
</li>
<li><em>by-variable</em>：指定匹配变量，主数据集和事物数据集按变量的值 匹配</li>
</ul>
<p>主数据集和事物数据集需先按BY变量排序；UPDTATE只有一种用法，其后必须跟BY语句；主数据集中，BY变量的值应该唯一，否则只会更新相同值的首条记录，事物数据集中BY变量值可以不唯一，更新的数据集最终会以最后一条为准。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">data raw;/*主数据集*/</div><div class="line">    name=&quot;吴源燚&quot;;gender=&quot;&quot;;age=2;Location=&quot;SH&quot;;output;</div><div class="line">    name=&quot;WUYY&quot;;gender=&quot;M&quot;;age=.;Location=&quot;SH&quot;;output;</div><div class="line">run;</div><div class="line"></div><div class="line">data new;/*事物数据集*/</div><div class="line">    name=&quot;吴源燚&quot;;gender=&quot;M&quot;;</div><div class="line">    name=&quot;WUYY&quot;;age=25;output;</div><div class="line">run;</div><div class="line"></div><div class="line">proc sort data=raw; /*排序*/</div><div class="line">    by name;</div><div class="line">run;</div><div class="line"></div><div class="line">proc sort data=new;</div><div class="line">    by name;</div><div class="line">run;</div><div class="line"></div><div class="line">data want; /*用事物数据集更新主数据集*/</div><div class="line">    update raw new;</div><div class="line">    by name;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="行列转置"><a href="#行列转置" class="headerlink" title="行列转置"></a>行列转置</h3><p><strong>PROC TRANSPOSE</strong> &lt;DATA=<em>input-data-set</em>&gt; &lt;DELIMITER=<em>delimiter</em>&gt; &lt;LABEL=<em>label</em>&gt; &lt;LET&gt; &lt;NAME=<em>name</em>&gt; &lt;OUT=<em>output-data-set</em>&gt; &lt;PREFIX=<em>prefix</em>&gt; &lt;SUFFIX=<em>suffix</em>&gt;;</p>
<p><strong>BY</strong> &lt;DESCENDING&gt; <em>variable-1</em> &lt;&lt;DESCENDING&gt; <em>variable-2</em>&gt; &lt;NOTSTORED&gt;;</p>
<p><strong>COPY</strong> <em>variable(s)</em>;</p>
<p><strong>ID</strong> <em>variable</em>;</p>
<p><strong>IDLABEL</strong> <em>variable</em>;</p>
<p><strong>VAR</strong> <em>variable(s)</em>;</p>
<p><strong>RUN</strong>;</p>
<ul>
<li>DATA=input-data-set：待转置数据集名称</li>
<li>DELIMITER=<em>delimiter</em>：ID语句有多个变量时，变量值之间所加的连字符</li>
<li>LABEL=<em>label</em>：转置变量的标签存储在新数据集中的变量名，默认_LABEL_</li>
<li>LET：当ID变量的值有重复时使用，此时只有每组ID的最后一条观测被转置</li>
<li>NAME=<em>name</em>：转置变量在新数据集中的名字，默认为_NAME_</li>
<li>OUT=<em>output-data-set</em>：转置后数据集名称</li>
<li>PREFIX=<em>prefix</em>：给转置变量在新数据集中的变量名加前缀</li>
<li>SUFFIX=<em>suffix</em>：给转置变量在新数据集中的变量名加后缀</li>
<li>BY：制定分组转置的变量，如果没有加NOTSTORED选项，原数据集应该先用PRCO SORT语句按BY语句指定的变量排序</li>
<li>COPY：拷贝变量，此变量不转置，直接拷贝到新数据集中</li>
<li>ID：标识变量，用此变量的值标识转置后变量的名称，多个标识变量时，需要DELIMITER指定连字符</li>
<li>IDLABEL：给转置后的变量添加标签</li>
<li>VAR：待转置的变量，SAS将对此变量进行行列互换操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">data wide; /*创建宽表*/</div><div class="line">input SID $  Programming Stats English;</div><div class="line">datalines;</div><div class="line">S01 98 100 80</div><div class="line">S02 84 98 94</div><div class="line">S03 89 92 88</div><div class="line">;</div><div class="line">run;</div><div class="line"></div><div class="line">proc transpose data=wide out=long(rename=(_name_=Coursename col1=Score));</div><div class="line">    var Programming Stats English;</div><div class="line">    by SID;</div><div class="line">run;</div><div class="line"></div><div class="line">data long(keep= SID Coursename Score);</div><div class="line">    set wide;</div><div class="line">    array scores&#123;*&#125; Programming Stats English;</div><div class="line">    do i=1 to dim(scores);</div><div class="line">        Coursename=vname(scores&#123;i&#125;);</div><div class="line">        Score=Scores&#123;i&#125;</div><div class="line">    end;</div><div class="line">run;</div><div class="line"></div><div class="line">proc transpose data=long out=Rewide(drop=_name_);</div><div class="line">    var Score;</div><div class="line">    by SID;</div><div class="line">    id Coursename;</div><div class="line">run;</div><div class="line"></div><div class="line">data Rewide(keep=SID Programming Stats English);</div><div class="line">    format SID Programming Stats English;</div><div class="line">    array Course&#123;3&#125; Programming Stats English;</div><div class="line">    do i=1 to 3;</div><div class="line">        set long;</div><div class="line">        Course&#123;i&#125;=Score;</div><div class="line">    end;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="横向拼接（并接）"><a href="#横向拼接（并接）" class="headerlink" title="横向拼接（并接）"></a>横向拼接（并接）</h3><h4 id="一对一读入（One-to-one-Reading）"><a href="#一对一读入（One-to-one-Reading）" class="headerlink" title="一对一读入（One-to-one Reading）"></a>一对一读入（One-to-one Reading）</h4><ul>
<li>用多SET语句并接多个数据集，当数据集里的观测数不等时，SAS读完观测数最少的那个数据集后即停止执行。</li>
<li>当多个数据集里的变量有重复时，后面的值会覆盖前面的值。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">data class1(keep=name sex) class2(keep=age height weighr); </div><div class="line">    set sashelp.class;</div><div class="line">    output class1;</div><div class="line">    output class2;</div><div class="line">run;</div><div class="line"></div><div class="line">data class;</div><div class="line">    set class1;</div><div class="line">    set class2;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h4 id="一对一并接（One-to-one-Merging）"><a href="#一对一并接（One-to-one-Merging）" class="headerlink" title="一对一并接（One-to-one Merging）"></a>一对一并接（One-to-one Merging）</h4><ul>
<li>数据不对等时，不会停止执行。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">data class;</div><div class="line">    merge class1; class2;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h4 id="匹配并接（Matching-Merging）"><a href="#匹配并接（Matching-Merging）" class="headerlink" title="匹配并接（Matching Merging）"></a>匹配并接（Matching Merging）</h4><ul>
<li>在使用MERGE语句前需用PROC SORT过程给匹配变量排序，在其之后需紧接BY语句指定匹配变量。</li>
<li>可同时MERGE多个数据集，对于相同的变量，后一个数据集里的值会覆盖前一个数据的值。</li>
<li>并接两个数据集时，BY变量可能不唯一。一个数据集重复的BY值有m个，另一数据集重复的BY值有n个，则MERGE后，这些重复的BY值将产生m*n条结果。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">data class1(keep=name sex) class2(keep=name age height weight);</div><div class="line">    set sashelp.class;</div><div class="line">    out class1;</div><div class="line">    if _n_ in (1, 5, 10, 15) then output class2;</div><div class="line">run;</div><div class="line"></div><div class="line">data class2;</div><div class="line">    ser class2;</div><div class="line">    if name=&quot;Janet&quot; then name=&quot;Janey&quot;;</div><div class="line">run;</div><div class="line"></div><div class="line">proc sort data=class2;</div><div class="line">    by name;</div><div class="line">run;</div><div class="line"></div><div class="line">proc sort data=class2;</div><div class="line">    by name;</div><div class="line">run;</div><div class="line"></div><div class="line">data class_left; /*左连接*/</div><div class="line">    merge class1(in=ds1) class2(in=ds2);</div><div class="line">    by name;</div><div class="line">    if ds1;</div><div class="line">run;</div><div class="line"></div><div class="line">data class_right; /*右连接*/</div><div class="line">    merge class1(in=ds1) class2(in=ds2);</div><div class="line">    by name;</div><div class="line">    if ds2;</div><div class="line">run;</div><div class="line"></div><div class="line">data class_inner; /*内连接*/</div><div class="line">    merge class1(in=ds1) class2(in=ds2);</div><div class="line">    by name;</div><div class="line">    if ds1 and ds2;</div><div class="line">run;</div><div class="line"></div><div class="line">data class_full; /*全连接*/</div><div class="line">    merge class1(in=ds1) class2(in=ds2);</div><div class="line">    by name;</div><div class="line">    if ds1 or ds2;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="纵向拼接（串接）"><a href="#纵向拼接（串接）" class="headerlink" title="纵向拼接（串接）"></a>纵向拼接（串接）</h3><h4 id="SET语句"><a href="#SET语句" class="headerlink" title="SET语句"></a>SET语句</h4><ul>
<li>SET语句后可以跟多个数据集或数据集列表</li>
<li>最终的数据集不会自动剔除重复行</li>
<li>为匹配的列值为空</li>
<li>字符型变量的长度为第一次出现的数据中的定义长度，后面相同的字段如果比前面更长，则会被截断，因此建议在SET语句前先用LENGTH语句申明其长度。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">data class1 class2 class3(keep=name sex) class4(keep=name age height weight);</div><div class="line">    set sashelp.class;</div><div class="line">    if _n_ &lt; 10 then do;</div><div class="line">        output class1;</div><div class="line">        output class2;</div><div class="line">    end;</div><div class="line">    else do;</div><div class="line">        output class2;</div><div class="line">        output class4;</div><div class="line">    end;</div><div class="line">run;</div><div class="line"></div><div class="line">data class;</div><div class="line">    set class1 class2;</div><div class="line">run;</div><div class="line"></div><div class="line">data class;</div><div class="line">    set class2 class4;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h4 id="PROC-APPEND"><a href="#PROC-APPEND" class="headerlink" title="PROC APPEND"></a>PROC APPEND</h4><p><strong>PROC APPEND</strong> BASE=&lt;<em>libref.</em>&gt;SAS-data-set &lt;APPENDVER=V6&gt; &lt;DATA=&lt;<em>libref.</em>&gt;SAS-data-set&gt; &lt;ENCRYPTKEY=<em>key-value</em>&gt; &lt;FROCE&gt; &lt;GETSORT&gt; &lt;NOWARN&gt;;</p>
<p><strong>RUN</strong>;</p>
<ul>
<li>BASE=&lt;<em>libref.</em>&gt;SAS-data-set：指定基础数据集，追加数据集的观测将写入此数据集中</li>
<li>APPENDVER：指定追加机制的版本，可以是V6或V7</li>
<li>DATA=&lt;<em>libref.</em>&gt;SAS-data-set：指定待追加数据集</li>
<li>ENCRYPTKEY=<em>key-value</em>：AES加密键值</li>
<li>FORECE：当追加数据集里的变量不在BASE数据集，或者变量类型和长度不同时，强制追加，不过此时LOG中会有警告信息，可以用NOWARN屏蔽</li>
<li>GETSORT：把BASE数据集的排序标识复制到追加数据集中</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">proc append base=class3 data=class4 force;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="制作变量字典"><a href="#制作变量字典" class="headerlink" title="制作变量字典"></a>制作变量字典</h3><p>利用ODS OUTPUT语句抓取PROC CONTENTS背后的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ods output Position=codebook；</div><div class="line">proc contents data=sashelp.cars order=varnum;</div><div class="line">run;</div><div class="line"></div><div class="line">proc export data=codebook outfile=&quot;d:\codeBook.csv&quot; dbms=csv replace;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="数据集信息"><a href="#数据集信息" class="headerlink" title="数据集信息"></a>数据集信息</h3><p>数据集权限有读、写、修改和全局四种，分别用READ=、WRITE=、ALTER=、PW=来设置。格式为：密码1/密码2，具体有五种形式：</p>
<ul>
<li>密码1：设置密码</li>
<li>密码1/密码2：修改密码1为密码2</li>
<li>密码2：不管旧密码是什么，设置新密码为密码2</li>
<li>密码1/：删除密码</li>
<li>/：删除密码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">proc datasets lib=sashelp; /*获取描述信息*/</div><div class="line">    contents data=class;</div><div class="line">run;</div><div class="line"></div><div class="line">proc datasets lib=sashelp;/*修改描述信息*/</div><div class="line">    modify class(label=&quot;学生测试数据集&quot; read=r2017);</div><div class="line">quit;</div></pre></td></tr></table></figure>
<h3 id="数据集操作"><a href="#数据集操作" class="headerlink" title="数据集操作"></a>数据集操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">proc datasets;</div><div class="line">    copy in=sashelp out=work; /*数据集集体拷贝*/</div><div class="line">    select class; /*选择数据集*/</div><div class="line">quit;</div><div class="line"></div><div class="line">proc datasets lib=work;</div><div class="line">    change class=student; /*数据集改名*/</div><div class="line">quit;</div><div class="line"></div><div class="line">proc datasets lib=work;</div><div class="line">    delete students; /*删除数据集*/</div><div class="line">quit;</div><div class="line"></div><div class="line">proc datasets lib=work kill memtype=data; /*删除Work库中所有数据集*/</div><div class="line">run;</div><div class="line"></div><div class="line">proc datasets lib=work;</div><div class="line">    save class; /*仅保留class*/</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="变量信息"><a href="#变量信息" class="headerlink" title="变量信息"></a>变量信息</h3><p>PROC DATASETS不是打开数据集，逐行操作，而是对数据集的描述信息直接操作，或者直接操作整体数据集。因此相比逐条操作的SET语句，PROC DATASETS在效率上要高很多。</p>
<p>PROC DATASETS配合MODIFY语句，可以修改变量的格式、标签以及重命名变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">proc  datasets;</div><div class="line">    modify sashelp.class;</div><div class="line">        format height weight 3.0;</div><div class="line">        rename sex=gender;</div><div class="line">        label name=&quot;姓名&quot; gender=&quot;性别&quot;;</div><div class="line">quit;</div></pre></td></tr></table></figure>
<h3 id="SAS字典"><a href="#SAS字典" class="headerlink" title="SAS字典"></a>SAS字典</h3><p>SAS Dictionary库是一个只读的SAS逻辑库，里面包含了与SAS会话相关的元数据（描述数据的数据），如数据集名、变量名、变量类型以及变量长度等这些描述变量的变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">proc sql;</div><div class="line">    title &quot;Dictionary库中所有的表&quot;;</div><div class="line">    select unique memname memlabel from dictionary.dictionaries;</div><div class="line">quit;</div></pre></td></tr></table></figure>
<p>SAS字典库里的表与其对应的SASHELP库下的视图</p>
<table>
<thead>
<tr>
<th>Dictionary库下的表名</th>
<th>SASHELP库下的视图名</th>
<th>主要作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>TABLES</td>
<td>Vtable</td>
<td>包含了诸如逻辑库名、数据文件名、数据文件的类型、观测值数、变量数等诸多信息</td>
</tr>
<tr>
<td>COLUMNS</td>
<td>Vcolumn</td>
<td>包含了变量名称、类型、长度和格式以及标签等诸多信息</td>
</tr>
<tr>
<td>MEMBERS</td>
<td>Vmember</td>
<td>包含了逻辑库名称、数据文件名、数据类型、路径等诸多信息</td>
</tr>
<tr>
<td>FORMATS</td>
<td>Vformat</td>
<td>包含了系统自带的格式信息</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">proc sql;</div><div class="line">    describe table dictionary.column; /*查看columns表结构*/</div><div class="line">quit;</div></pre></td></tr></table></figure>
<p>在指定逻辑库、数据集以及数据文件类型时，需用引号，且引号里面的字母是大学。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">proc sql; /*从字典库中获取SASHELP库下所有数据集信息*/</div><div class="line">    create tables desds as select memname, nobs, nvar from dictionary.tables</div><div class="line">    where libname=&quot;SASHELP&quot; and memtype=&quot;DATA&quot;;</div><div class="line">quit;</div><div class="line"></div><div class="line">proc sql; /*从视图中获取SASHELP库下所有数据集信息*/</div><div class="line">    create tables desds as select memname, nobs, nvar from sashelp.vtable</div><div class="line">    where libname=&quot;SASHELP&quot; and memtype=&quot;DATA&quot;;</div><div class="line">quit;</div><div class="line"></div><div class="line">proc sql; /*从字典库中获取数据集CARS的所有变量信息*/</div><div class="line">    create table varlist as select name, type, length, label from dictionary.columns</div><div class="line">    where libname=&quot;SASHELP&quot; and memname=&quot;CARS&quot;;</div><div class="line">quit;</div><div class="line"></div><div class="line">proc sql; /*从视图中获取数据集CARS的所有变量信息*/</div><div class="line">    create table varlist as select name, type, length, label from sashelp.vcolumn</div><div class="line">    where libname=&quot;SASHELP&quot; and memname=&quot;CARS&quot;;</div><div class="line">quit;</div></pre></td></tr></table></figure>
<h2 id="间有山川亦奇秀：函数例程"><a href="#间有山川亦奇秀：函数例程" class="headerlink" title="间有山川亦奇秀：函数例程"></a>间有山川亦奇秀：函数例程</h2><h3 id="函数语法"><a href="#函数语法" class="headerlink" title="函数语法"></a>函数语法</h3><p>可用于DATA步赋值语句、IF语句、WHERE表达式（语句或选项）、宏语句、PROC REPORT以及PROC SQL语句中。PRCO SQL的SELECT语句里的函数作用是纵向的，而其他函数的作用则是横向的。</p>
<p><em>function-name</em>(<em>argument-1</em>&lt;…*argument-n&gt;)</p>
<p><em>function-name</em>(OF <em>variable-list</em>)</p>
<p><em>function-name</em>(OF <em>array-name</em>[*])</p>
<p><em>function-name</em>(&lt;<em>argument</em>|OF <em>variable-list</em>| OF <em>array-name</em>[*]&gt; &lt;…, &lt;<em>argument</em>|OF <em>variable-list</em>| OF <em>array-name</em>[*]&gt;&gt;)</p>
<ul>
<li>function-name：函数名称</li>
<li>argument：参数，可以是变量名、常数、表达式、甚至还可以是其他函数</li>
<li>OF <em>variable-list</em>：参数列表</li>
<li>OF <em>array-name</em>[*]：数组名称，注意要带[*]</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data _null_;</div><div class="line">    array ex&#123;7&#125; (95 93 92 99 98 85 94);</div><div class="line">    avg_function1=mean(ex1, ex2, ex3, ex4, ex5, ex6, ex7); /*单个参数*/</div><div class="line">    avg_function2=mean(of ex1 ex2 ex3 ex4 ex5 ex6 ex7); /*变量清单*/</div><div class="line">    avg_function3=mean(of ex1-ex7); /*变量清单*/</div><div class="line">    avg_function4=mean(of ex:); /*变量清单*/</div><div class="line">    avg_function5=mean(of ex[*]; /*数组名*/</div><div class="line">    put (avg_function1 avg_function2 avg_function3 avg_function4 avg_function5) (=);</div><div class="line">    put avg_function1= avg_function2= avg_function3= avg_function4= avg_function5=;</div><div class="line">    /*put avg_function1 avg_function2 avg_function3 avg_function4 avg_function5;*/</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="例程语法"><a href="#例程语法" class="headerlink" title="例程语法"></a>例程语法</h3><p>主要用于DATA步的CALL语句中，不能用于赋值语句和表达式。</p>
<p>CALL <em>routine-name</em>(<em>argument-1</em>&lt;…*argument-n&gt;)</p>
<p>CALL <em>routine-name</em>(OF <em>variable-list</em>)</p>
<p>CALL <em>routine-name</em>(OF <em>array-name</em>[*])</p>
<p>CALL <em>routine-name</em>(&lt;<em>argument</em>|OF <em>variable-list</em>| OF <em>array-name</em>[*]&gt; &lt;…, &lt;<em>argument</em>|OF <em>variable-list</em>| OF <em>array-name</em>[*]&gt;&gt;)</p>
<ul>
<li>routine-name：函数名称</li>
<li>argument：参数，可以是变量名、常数、表达式、甚至还可以是其他函数</li>
<li>OF <em>variable-list</em>：参数列表</li>
<li>OF <em>array-name</em>[*]：数组名称，注意要带[*]</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">data tmp;</div><div class="line">    array str&#123;3&#125; $20 (&quot;统计思维&quot;,&quot;SAS编程演义&quot;,&quot;数据整理与图标呈现&quot;);</div><div class="line">    length result1-result5 $50;</div><div class="line">    call catx(&quot;-&quot;, result1, str1, str2, atr3);</div><div class="line">    call catx(&quot;-&quot;, result2, of str1 str2 atr3);</div><div class="line">    call catx(&quot;-&quot;, result3, of str1-atr3);</div><div class="line">    call catx(&quot;-&quot;, result4, of str:);</div><div class="line">    call catx(&quot;-&quot;, result5, of str[*]);</div><div class="line">    put (result1 result2 result3 result4 result5) (=);</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h3><p>借助PROC FCMP的FUNCTION语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">proc fcmp outlib=sasuser.funcs.trial;</div><div class="line">    function study_day(intervention_date, event_date); /*定义函数study_day*/</div><div class="line">        n=event_date - intervention_date;</div><div class="line">        if n &gt;= 0 then</div><div class="line">            n = n + 1;</div><div class="line">        return(n);</div><div class="line">    endsub;</div><div class="line">run;</div><div class="line"></div><div class="line">options cmplib=sasuser.funcs;</div><div class="line">data _null_;</div><div class="line">    start=&apos;15Feb2010&apos;d;</div><div class="line">    today=&apos;27Mar2010&apos;d;</div><div class="line">    sd=study_day(start, today);</div><div class="line">    put sd=;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="高频函数和例程"><a href="#高频函数和例程" class="headerlink" title="高频函数和例程"></a>高频函数和例程</h3><table>
<thead>
<tr>
<th>功能类别</th>
<th>函数名及其功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>数组处理</td>
<td>DIM：返回数组元素个数</td>
</tr>
<tr>
<td></td>
<td>HBOULD：返回数组上界</td>
</tr>
<tr>
<td></td>
<td>LBOULD：返回数组下界</td>
</tr>
<tr>
<td>字符处理</td>
<td>STRIP：掐头去尾移除空格</td>
</tr>
<tr>
<td></td>
<td>SUBSTR：提取、置换字符</td>
</tr>
<tr>
<td></td>
<td>TRANSLATE、TRANSTRN、TRANWRD：替换、移除字符</td>
</tr>
<tr>
<td></td>
<td>UPCASE、LOWCASE、PROPCASE：大小写转换</td>
</tr>
<tr>
<td></td>
<td>SCAN：扫描整个字符串，返回某部分字符串</td>
</tr>
<tr>
<td></td>
<td>FIND、FINDC、FINDW：查找字符，返回其位置</td>
</tr>
<tr>
<td></td>
<td>INDEX、INDEXC、INDEXW：查找字符，返回其位置</td>
</tr>
<tr>
<td></td>
<td>CATS、CATT、CATX及其CALL例程：字符串拼接</td>
</tr>
<tr>
<td>日期时间</td>
<td>DATE、TODAY：获取当前日期</td>
</tr>
<tr>
<td></td>
<td>YEAR、MONTH、DAY：分别截取年、月、日</td>
</tr>
<tr>
<td></td>
<td>MDY：月、日、年组合成完整日期</td>
</tr>
<tr>
<td></td>
<td>HOUR、MINUTE、SECOND：分别截取时、分、秒</td>
</tr>
<tr>
<td></td>
<td>HMS：时、分、秒组合成完整时间</td>
</tr>
<tr>
<td></td>
<td>INTCK：计算日期、时间、日期时间间的间隔</td>
</tr>
<tr>
<td></td>
<td>INTNX：给定间隔的下一个日期、时间、日期时间</td>
</tr>
<tr>
<td>统计描述</td>
<td>N、NMISS：分别统计非缺失、缺失的个数</td>
</tr>
<tr>
<td></td>
<td>SUM：求和</td>
</tr>
<tr>
<td></td>
<td>MEAN：均数</td>
</tr>
<tr>
<td></td>
<td>STD、STDERR：标准差、标准误</td>
</tr>
<tr>
<td></td>
<td>CV：变异系数</td>
</tr>
<tr>
<td></td>
<td>IQR：分位数间隔</td>
</tr>
<tr>
<td></td>
<td>MISSING：判断是否缺失</td>
</tr>
<tr>
<td>宏函数</td>
<td>CALL SYMPUT、CALL SYMPUTX：DATA步赋值宏变量</td>
</tr>
<tr>
<td></td>
<td>SYMEXIT：判断宏变量是否存在</td>
</tr>
<tr>
<td></td>
<td>SYMGET：DATA步运行阶段获取宏变量值</td>
</tr>
<tr>
<td>截断函数</td>
<td>TRAN：强行截断</td>
</tr>
<tr>
<td></td>
<td>ROUND：四舍五入</td>
</tr>
<tr>
<td></td>
<td>INT、CELL、FLOOR：直接取整、向上取整、向下取整</td>
</tr>
<tr>
<td>变量信息</td>
<td>VNAME：获取变量名</td>
</tr>
<tr>
<td></td>
<td>VTYPE：获取变量类型</td>
</tr>
<tr>
<td></td>
<td>VLABEL：获取变量标签</td>
</tr>
<tr>
<td>特殊函数</td>
<td>INPUT、PUT：数据类型转换</td>
</tr>
<tr>
<td></td>
<td>LAG、DIF：不同观测号间的值与差值</td>
</tr>
</tbody>
</table>
<h2 id="翩跹翠袖拂云裳：巧用格式"><a href="#翩跹翠袖拂云裳：巧用格式" class="headerlink" title="翩跹翠袖拂云裳：巧用格式"></a>翩跹翠袖拂云裳：巧用格式</h2><h3 id="格式名"><a href="#格式名" class="headerlink" title="格式名"></a>格式名</h3><p>&lt;$&gt;<em>format-name</em>&lt;w&gt;.&lt;d&gt;</p>
<p>$：标明是否为字符格式，有$的为字符格式，无则为数字格式</p>
<p><em>format-name</em>：格式名称，可以是SAS系统自带也可以是用户在PROC FORMAT的VALUE语句中自定义的</p>
<p><em>w</em>：格式的宽度</p>
<p><em>d</em>：小数的位数</p>
<p>.：w和d均可以没有，但其之间的点必须保留</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">/*获取系统内置格式清单*/</div><div class="line">proc sql;</div><div class="line">    create table SysFormats as select distinct fmtname from dictionary.formats;</div><div class="line">quit;</div><div class="line"></div><div class="line">proc print data= SysFormats;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="常用输入格式"><a href="#常用输入格式" class="headerlink" title="常用输入格式"></a>常用输入格式</h3><table>
<thead>
<tr>
<th>类别</th>
<th>格式名</th>
<th>作用简介</th>
</tr>
</thead>
<tbody>
<tr>
<td>字符</td>
<td>$CHARw.</td>
<td>读入带空格的字符</td>
</tr>
<tr>
<td></td>
<td>$w.</td>
<td>标准字符格式</td>
</tr>
<tr>
<td>日期时间</td>
<td>ANYDTDTEw.</td>
<td>“万能”读入日期格式</td>
</tr>
<tr>
<td></td>
<td>ANYDTDTMw.</td>
<td>“万能”读入日期时间格式</td>
</tr>
<tr>
<td></td>
<td>ANYDTTMEw.</td>
<td>“万能”读入时间格式</td>
</tr>
<tr>
<td></td>
<td>DATEw.</td>
<td>读入格式为ddmmyy或ddmmyyyy的日期</td>
</tr>
<tr>
<td></td>
<td>DATETIMEw.</td>
<td>读入格式为ddmmyy hh:mm:ss或ddmmyyyy hh:mm:ss的日期时间</td>
</tr>
<tr>
<td></td>
<td>DDMMYYw.</td>
<td>读入格式为ddmmyy&lt;yy&gt;或者dd-mm-yy&lt;yy&gt;格式的日期，连字符可以是- . /</td>
</tr>
<tr>
<td></td>
<td>HHMMSSw.</td>
<td>读入格式为hh:mm:ss或hhmmss的时间</td>
</tr>
<tr>
<td></td>
<td>MMDDYYw.</td>
<td>读入格式为mmddyy或mmddyyyy的日期</td>
</tr>
<tr>
<td>数字</td>
<td>COMMAw.d</td>
<td>读入数字时移除数字间的逗号</td>
</tr>
<tr>
<td></td>
<td>w.d</td>
<td>读入标准数字格式</td>
</tr>
<tr>
<td></td>
<td>PERCENTw.d</td>
<td>读入百分比数字</td>
</tr>
</tbody>
</table>
<h3 id="常用输出格式"><a href="#常用输出格式" class="headerlink" title="常用输出格式"></a>常用输出格式</h3><table>
<thead>
<tr>
<th>类别</th>
<th>格式名</th>
<th>作用简介</th>
</tr>
</thead>
<tbody>
<tr>
<td>字符</td>
<td>$w.</td>
<td>标准字符格式，w表示变量的宽度</td>
</tr>
<tr>
<td></td>
<td>$IPCASEw.</td>
<td>把字符转成大写，相当于UPCASE函数</td>
</tr>
<tr>
<td>日期时间</td>
<td>DATETIMEw.d</td>
<td>显示日期时间格式为ddmmmyy:hh:mm:ss.ss</td>
</tr>
<tr>
<td></td>
<td>DATEw.</td>
<td>显示日期格式为ddmmmyy，ddmmmyyyy，或dd-mmm-yy</td>
</tr>
<tr>
<td></td>
<td>YYMMDDw.</td>
<td>显示日期格式为yymmdd或&lt;yy&gt;yy-mm-dd</td>
</tr>
<tr>
<td></td>
<td>HHMMw.d</td>
<td>显示时间格式为hh:mm</td>
</tr>
<tr>
<td>数字</td>
<td>BESTw.</td>
<td>SAS自动选择最合适的数字格式</td>
</tr>
<tr>
<td></td>
<td>COMMAw.d</td>
<td>带千分位的数字格式</td>
</tr>
<tr>
<td></td>
<td>DOLLARw.d</td>
<td>带美元符号的格式</td>
</tr>
<tr>
<td></td>
<td>PERCENTw.d</td>
<td>显示百分比形式</td>
</tr>
<tr>
<td></td>
<td>PVALUEw.d</td>
<td>统计P值显示格式</td>
</tr>
<tr>
<td></td>
<td>w.d</td>
<td>标准的数字格式</td>
</tr>
<tr>
<td></td>
<td>Zw.d</td>
<td>前面位数不够补0填充</td>
</tr>
</tbody>
</table>
<h3 id="自定义格式"><a href="#自定义格式" class="headerlink" title="自定义格式"></a>自定义格式</h3><p><strong>PROC FORMAT</strong> &lt;<em>option(s)</em>&gt;;</p>
<p><strong>EXCLUDE</strong> <em>entry(s)</em>;</p>
<p><strong>INVALUE</strong> &lt;$&gt;<em>name</em>&lt;(<em>informat-option(s)</em>)&gt;&lt;<em>value-range-set(s)</em>&gt;;</p>
<p><strong>PICTURE</strong> <em>name</em>&lt;(<em>format-option(s)</em>)&gt; &lt;<em>value-range-set-1</em>&lt;(<em>picture-1-option(s)</em>)&gt; &lt;value-range-set-2&lt;(*picture-2-option(s))&gt;&gt; …&gt;;</p>
<p><strong>SELECT</strong> <em>entry(s)</em>;</p>
<p><strong>VALUE</strong>  &lt;$&gt;<em>name</em>&lt;(<em>format-option(s)</em>)&gt; &lt;<em>value-range-set(s)</em>&gt;</p>
<p><strong>RUN</strong>;</p>
<ul>
<li>option(s)：PRCO FORMAT的一些选项，如：<ul>
<li>library=：指定格式存放位置</li>
<li>ctnlin=：指定格式定义输入数据集</li>
<li>ctnlout=：指定格式定义到出数据集</li>
</ul>
</li>
<li><strong>EXCLUDE</strong>：剔除某些条目</li>
<li><strong>INVALUE</strong>：定义输入格式<ul>
<li><em>name</em>：输入格式名，前面有$表示为字符格式名</li>
<li><em>informat-option(s)</em>：输入格式选项</li>
<li><em>value-range-set(s)</em>：数据映射</li>
</ul>
</li>
<li><strong>PICTURE</strong>：创建打印数字的模版</li>
<li><strong>VALUE</strong>：定义输出格式<ul>
<li><em>name</em>：输出格式名，前面有$表示为字符格式名</li>
<li><em>informat-option(s)</em>：输出格式选项</li>
<li><em>value-range-set(s)</em>：数据映射，其形式可以是：<em>value-or-range-1 &lt;, value-or-range-2, …&gt;=formatted-value|[existing-format]</em></li>
</ul>
</li>
</ul>
<p>直接用输入数据来定义格式时，输入数据集里必须包含五个重要字段名：FMTNAME、START、END、LABEL以及TYPE。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">proc format cntlout=fmt; /*自定义格式，导出格式定义数据*/</div><div class="line">    value $sexf F=&quot;男性&quot; M=&quot;女性&quot;;</div><div class="line">run;</div><div class="line"></div><div class="line">proc format library=work cntlin=fmt(keep=fmtname start end label type); /*用数据集定义格式*/</div><div class="line">run;</div></pre></td></tr></table></figure>
<ul>
<li>格式命名：格式命名长度不得超过32个字符（包括$），且不得以数字结尾</li>
<li>数据映射中，数据范围写法：<ul>
<li>单独的值映射：如「F=”男性” M=”女性”」,「1=”低” 2=”中” 3=”高”」</li>
<li>值范围的映射：如「18.5-24.9=”正常”」,「’A’-‘D’=”Class1”」</li>
<li>单用连字符“-”时，是闭区间，包括两边边界值。如果希望不包括边界，可在其前加“&lt;”，如：「18.5-&lt;25=”正常”」</li>
<li>可用关键词LOW，HEIGH，OTHER：如「low-&lt;65=”&lt;65岁” 65-high=”&gt;=65岁”」</li>
<li>可以嵌套格式名，但是需要将嵌套的格式名置于种括号中或小括号里的双竖线中，如：「.=”缺失” other=[yymmdd10.];」</li>
</ul>
</li>
<li>定义好的格式，如果在DATA步用FORMAT关联变量，则为永久性的；如果只在过程步用FORMAT关联变量，则为临时性的。</li>
</ul>
<h3 id="格式妙用"><a href="#格式妙用" class="headerlink" title="格式妙用"></a>格式妙用</h3><h4 id="格式的使用范围"><a href="#格式的使用范围" class="headerlink" title="格式的使用范围"></a>格式的使用范围</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">data _null_; /*DATA步 PUT语句中指定*/</div><div class="line">    set sashelp.class(obs=5);</div><div class="line">    put name sex $sexf.;</div><div class="line">run;</div><div class="line"></div><div class="line">prco print data=sashelp.class(obs=5); /*PROC步FORMAT语句指定*/</div><div class="line">    var name sex;</div><div class="line">    format sex $sexf.;</div><div class="line">run;</div><div class="line"></div><div class="line">proc sql; /*Proc sql中format选项*/</div><div class="line">    select name, sex format=$sexf. from sashelp.class(obs=5);</div><div class="line">quit;</div></pre></td></tr></table></figure>
<h4 id="变量重分组"><a href="#变量重分组" class="headerlink" title="变量重分组"></a>变量重分组</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">data obese; /*创建测试数据集*/</div><div class="line">    length status $ 15;</div><div class="line">    set sashelp.class;</div><div class="line">    BMI = weight*0.4536/(height*0.0254)**2;</div><div class="line">run;</div><div class="line"></div><div class="line">proc format; /*自定义格式*/</div><div class="line">    value obefmt low-18.5=&quot;Underweight&quot; 18.5-25=&quot;Normal&quot; </div><div class="line">                 25-30=&quot;Overweight&quot; 30-high=&quot;Obese&quot;;</div><div class="line">run;</div><div class="line"></div><div class="line">proc freq data=obese; /*愿变量+格式直接统计新分类的频数*/</div><div class="line">    table bmi;</div><div class="line">    format bmi obefmt.;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h4 id="统计分析过程"><a href="#统计分析过程" class="headerlink" title="统计分析过程"></a>统计分析过程</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">/*在统计分析过程里，直接用自定义格式给变量重分组*/</div><div class="line">proc format;</div><div class="line">    value obefmt low-18.5=&quot;Underweight&quot; 18.5-high=&quot;Normal or above&quot;;</div><div class="line">run;</div><div class="line"></div><div class="line">proc logistic data=obese;</div><div class="line">    class sex;</div><div class="line">    model bmi(event=&quot;Underweight&quot;)=age sex;</div><div class="line">    format bmi obefmt.;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h4 id="统计缺失观测"><a href="#统计缺失观测" class="headerlink" title="统计缺失观测"></a>统计缺失观测</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">proc format; /*自定义格式*/</div><div class="line">    value $missfmt &apos; &apos;=&quot;Missing&quot; other=&quot;Not Missing&quot;; /*引号中有多少空格都一样*/</div><div class="line">    value nmissfmt .=&quot;Missing&quot; other=&quot;Not Missing&quot;;</div><div class="line">run;</div><div class="line"></div><div class="line">data class; /*创建测试数据集*/</div><div class="line">    set sashelp.class;</div><div class="line">    if rannor(123)&lt;0.5 then call missing(sex);</div><div class="line">    if rannor(456)&lt;0.05 then call missing(age);</div><div class="line">run;</div><div class="line"></div><div class="line">proc freq data=class; /*统计缺失、非缺失频数*/</div><div class="line">    table sex age/missing;</div><div class="line">    format sex $missfmt. age nmissfmt.;</div><div class="line">run;</div><div class="line"></div><div class="line">data cclass;</div><div class="line">    set class;</div><div class="line">    if name=&apos;Henry&apos; then sex=&apos;  &apos;;</div><div class="line">run;</div><div class="line"></div><div class="line">proc freq data=cclass; /*统计缺失、非缺失频数*/</div><div class="line">    table sex age/missing;</div><div class="line">    format sex $missfmt. age nmissfmt.;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h4 id="条件显示"><a href="#条件显示" class="headerlink" title="条件显示"></a>条件显示</h4><p>利用自定义格式，可以依据不同的条件，按不同风格显示值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">proc format;</div><div class="line">    value obefmt low-18.5=&quot;red&quot; 18.5-high=&quot;black&quot;;</div><div class="line">run;</div><div class="line"></div><div class="line">proc report data=obese nowd split=&apos;~&apos; style(report)=[background=white foreground=black];</div><div class="line">    column name sex age bmi;</div><div class="line">    define name/display;</div><div class="line">    define sex/display;</div><div class="line">    define age/display;</div><div class="line">    define bmi/format=4.1 style=[foreground=obefmt.];</div><div class="line">run;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/09/13/SAS编程演义1-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/13/SAS编程演义1-4/" itemprop="url">《SAS编程演义》笔记（1-4章）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-13T09:35:24+08:00">
                2017-09-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="清歌苦调两不厌：夯实基础"><a href="#清歌苦调两不厌：夯实基础" class="headerlink" title="清歌苦调两不厌：夯实基础"></a>清歌苦调两不厌：夯实基础</h2><h3 id="如何让SAS自动加载永久逻辑库"><a href="#如何让SAS自动加载永久逻辑库" class="headerlink" title="如何让SAS自动加载永久逻辑库"></a>如何让SAS自动加载永久逻辑库</h3><ol>
<li>如果想要让SAS语句建立的永久库在启动后就能看到，可以把包含LIBNAME语句的程序命名为autoexe.sas，并放入和sas.exe同级的目录中，此后每次SAS启动时会自动运行autosas.exe程序。</li>
<li>通过工具按钮建立永久库时，可以在建立时勾上<em>Enable at startup</em>，下次启动SAS时就会自动加载这个永久库。</li>
</ol>
<h3 id="为什么又了数据文件还要视图"><a href="#为什么又了数据文件还要视图" class="headerlink" title="为什么又了数据文件还要视图"></a>为什么又了数据文件还要视图</h3><p>视图是依据查询语句动态生成，因此视图本身几乎不占据存储空间。利用视图可以节约硬盘空间。两者在世界内容效果方面是一样的。</p>
<h3 id="日期与时间的本质"><a href="#日期与时间的本质" class="headerlink" title="日期与时间的本质"></a>日期与时间的本质</h3><ol>
<li>日期实际存储的是距离1960年1月1日的天数</li>
<li>时间是距离凌晨的秒数</li>
</ol>
<h3 id="打破SAS命名规则"><a href="#打破SAS命名规则" class="headerlink" title="打破SAS命名规则"></a>打破SAS命名规则</h3><p>修改系统选项<code>VALIDMEMNAME</code>和<code>VALIDVARNAME</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">options VALIDMEMNAME=extend VALIDVARNAME=any;</div><div class="line">data 中文名演示;</div><div class="line">    SAS中文变量名 = &quot;YES&quot;;</div><div class="line">    SAS中文變量名 = &quot;YES&quot;;</div><div class="line">    &apos;2SAS中文变量名&apos;n = &quot;YES&quot;;</div><div class="line">    &apos;SAS空格 #@%特殊字符变量名&apos;n = &quot;YES&quot;;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><ul>
<li>不等于 ^= ~= </li>
<li>两者取小 &gt;&lt;</li>
<li>两者取大 &lt;&gt;</li>
<li>连接运算符 ||</li>
<li>与 &amp; and</li>
<li>或 ! | or</li>
<li>非 ^ ~ not</li>
</ul>
<h3 id="IF-ELSE配合DO-END"><a href="#IF-ELSE配合DO-END" class="headerlink" title="IF-ELSE配合DO-END"></a>IF-ELSE配合DO-END</h3><p>希望执行的不仅仅是一个动作，而是多个动作，此时可以在关键词THEN后面用夹板语句DO-END，把多个动作整合在DO-END中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">data male female;</div><div class="line">  set sashelp.class;</div><div class="line">       if sex=&apos;M&apos; then do; gender=&apos;Male&apos;; output male; end;</div><div class="line">  else if sex=&apos;F&apos; then do; gender=&apos;Female&apos;; output female; end;</div><div class="line">  else put &apos;Invalid sex :&apos; sex;</div><div class="line">run;</div></pre></td></tr></table></figure></p>
<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><ul>
<li>DO-END</li>
<li>DO-WHILE</li>
<li>DO-UNTIL<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">data random;</div><div class="line">    do i=1 to 10;</div><div class="line">        r=rannor(23);</div><div class="line">        output;</div><div class="line">    end;</div><div class="line">run;</div><div class="line"></div><div class="line">data dowhile;</div><div class="line">    i=0;</div><div class="line">    do while(i&lt;5);</div><div class="line">        i+1;</div><div class="line">        output;</div><div class="line">    end;</div><div class="line">run;</div><div class="line"></div><div class="line">data dountil;</div><div class="line">    i=0;</div><div class="line">    do until(i&gt;=5);</div><div class="line">        i+1;</div><div class="line">        output;</div><div class="line">    end;</div><div class="line">run;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="数组结构"><a href="#数组结构" class="headerlink" title="数组结构"></a>数组结构</h3><ul>
<li>数组中的变量必须有相同的数据类型</li>
<li><code>ARRAY array-name {number-of-elements} &lt;$&gt; &lt;length&gt; &lt;array-elements&gt; &lt;(initial-value-list)&gt;</code></li>
<li>元素个数可以用{*}代替，让SAS自动计数；可以指定具体的数字，如{7}；可以指定一定的数字范围，如{1:7}</li>
<li>元素名可以是变量名也可以是SAS自定义变量，如_ALL_（变量类型需相同，_NUMERIC_，_CHARACTER_，_TEMPORARY_（临时变量）</li>
<li>&lt;&gt;中的内容并非必须有。如$和length只有在数组元素为字符型时才用到。</li>
</ul>
<p>PDV与DATA步自循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data demoPDV;</div><div class="line">    put &quot;第&quot; _n_ &quot;次前运行：&quot; _all_;</div><div class="line">    input ID $  Chiness  Math  English;</div><div class="line">    Sum = Chiness + Math + English;</div><div class="line">    put &quot;第&quot; _n_ &quot;次后运行：&quot; _all_;</div><div class="line">datalines;</div><div class="line">S001 80 99 93</div><div class="line">S002 90 85 95</div><div class="line">S003 83 88 81</div><div class="line">;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="与"><a href="#与" class="headerlink" title="@与@@"></a>@与@@</h3><ul>
<li>当DATALINES数据行里要读入的数据列数=要读入的变量数，也就是说一行就是一条观测时，无尾。</li>
<li>当DATALINES数据行里要读入的数据列数&gt;要读入的变量数，而且是整数倍时，也就是说一行=K*数条观测(K为&gt;=1的整数)，用@@。</li>
<li><p>当一个DATA步里有多个INPUT语句时，我们需要单尾@。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">* 数据列数=变量数</div><div class="line">data test1;</div><div class="line">    input id x y z;</div><div class="line">    datalines;</div><div class="line">    1 98 99 97</div><div class="line">    2 93 91 92</div><div class="line">    ;</div><div class="line">run;</div><div class="line"></div><div class="line">* 数据列数=变量数，多个input语句</div><div class="line">data test2;</div><div class="line">    input id@;</div><div class="line">    input x@;</div><div class="line">    input y@;</div><div class="line">    input z@;</div><div class="line">    datalines;</div><div class="line">    1 98 99 97</div><div class="line">    2 93 91 92</div><div class="line">    ;</div><div class="line">run;</div><div class="line"></div><div class="line">* 数据列数=k*变量数</div><div class="line">data test3;</div><div class="line">    input id x y z @@;</div><div class="line">    datalines;</div><div class="line">    1 98 99 97 2 93 91 92;</div><div class="line">run;</div></pre></td></tr></table></figure>
<ul>
<li>无尾Hold不住立即跳</li>
<li>一尾(@)Hold住当前INPUT语句不跳，但若刚好是DATA步最后一个INPUT语句，跳。</li>
<li>二尾(@@)打死都不跳。</li>
<li>最后，无论多少尾，数据行末尾必定自动跳。</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">data test;</div><div class="line">    input x @;</div><div class="line">    input y;</div><div class="line">    input @@;</div><div class="line">datalines;</div><div class="line">1 2 3</div><div class="line">4 5 6</div><div class="line">7</div><div class="line">;</div><div class="line">run;</div><div class="line"></div><div class="line">data test;</div><div class="line">    input x;</div><div class="line">    input y @@;</div><div class="line">    input z @;</div><div class="line">datalines;</div><div class="line">1 2 3</div><div class="line">4 5 6</div><div class="line">7</div><div class="line">;</div><div class="line">run;</div></pre></td></tr></table></figure>
<hr>
<h2 id="苔点狂吞纳线青：读取数据"><a href="#苔点狂吞纳线青：读取数据" class="headerlink" title="苔点狂吞纳线青：读取数据"></a>苔点狂吞纳线青：读取数据</h2><h3 id="读取方式"><a href="#读取方式" class="headerlink" title="读取方式"></a>读取方式</h3><ul>
<li>LIBNAME语句</li>
<li>SQL直通设施(SQL pss-through facility)</li>
<li>ACCESS/DBLOAD过程，已不推荐</li>
<li>IMPORT/EXPORT过程</li>
<li>INFILE+INPUT语句</li>
<li>INPUT+DATALINES语句</li>
<li>IO函数</li>
</ul>
<h3 id="LIBNAME访问DBMS数据文件"><a href="#LIBNAME访问DBMS数据文件" class="headerlink" title="LIBNAME访问DBMS数据文件"></a>LIBNAME访问DBMS数据文件</h3><p><strong>LIBNAME</strong> <em>libref</em> <em>engine-name</em> \&lt;<em>SAS/ACCESS-connection-options</em>> \&lt;<em>SAS/ACCESS-LIBNAME-options</em>>;</p>
<p><code>libname mydb2 db2 user=yuanyi password=&quot;wuyuanyi&quot; datasrc=datadb</code></p>
<ul>
<li>libref: 逻辑库名，其实是存放数据表和视图的DBMS数据库、架构、服务器端别名</li>
<li>engine-name: 引擎名,不同的DMBS数据文件需要指定不同的引擎名，入oracle、db2等</li>
<li>SAS/ACCESS 连接选项，常用的如用户名，密码等，不同的DMBS数据文件会有所不同</li>
<li>SAS／ACCESS 逻辑库选项，控制SAS处理DBMS对象的方式，不同的DBMS数据文件会有所不同</li>
</ul>
<h3 id="PROC-IMPORT语法"><a href="#PROC-IMPORT语法" class="headerlink" title="PROC IMPORT语法"></a>PROC IMPORT语法</h3><p><strong>PROC IMPORT</strong></p>
<p><strong>DATAFILE</strong> = <em>“filename”</em>|<strong>DATATABLE</strong> = “<em>tablename</em>“(<em>Not used for Microsoft Excel files</em>)</p>
<p>&lt;DBMS = <em>data-source-identifier</em>&gt;</p>
<p>&lt;OUT = <em>libref.SAS data-set-name</em>> \&lt;<em>SAS data-set-option(s)</em>&gt;</p>
<p>&lt;REPLACE&gt;</p>
<p>&lt;<em>file-format-specofoc-statements</em>&gt;;</p>
<p><strong>RUN</strong>;</p>
<ul>
<li>filename: 欲读入的文件，包括路径、文件名以及扩展名（如：d:\mydata.xls），当然也可以用之前定义的fileref</li>
<li>data source identifier: 一般情况下与文件扩展名一致，.mdb、.dbf、.dat、.sav等。如果是excel文件，建议用Excel</li>
<li>&lt;OUT句&gt;: 读入数据后存放的SAS数据库和数据集名称</li>
<li>&lt;SAS data-set-option(s)&gt;：对保存的数据进行数据集读写，变量筛选，观测筛选等方面的控制<ul>
<li>PW=选项加密数据集</li>
<li>READ=、WRITE=、ALTER=选项分别加密读、写以及修改权限</li>
<li>KEEP=、DROP=、RENAME=选项筛选、重命名变量</li>
<li>OBS=、WHERE=筛选保留的观测</li>
</ul>
</li>
<li>&lt;REPLACE&gt;: 重复运行时替换掉同名数据集</li>
<li>&lt;file-format-specific-statements&gt;: 对分隔符分隔的文件（如CSV文件）、EXCEL文件、Access数据文件、dBase数据文件、Paradox数据文件、SPSS以及Stata数据文件做更详细的读取设置</li>
<li>对于分隔符分隔的文件<ul>
<li>DATAROW=n 指定数据从第n行开始</li>
<li>GETNAMES=YES|NO 应对数据文件首行是不是变量名</li>
<li>GUESSINGROWS=n|MAX 应对仅用默认头20行数据无法判断变量类型和长度的情况</li>
<li>DELIMITER=‘char’|’nn’x 个性化指定数据文件的分隔符，如DELIMITER=‘#’|‘20’x（十六进制ascii码的空格）</li>
</ul>
</li>
<li>对于EXCEL文件<ul>
<li>SHEET=EXCEL文件中特定的sheet</li>
<li>RANGE=读入某sheet中特定的数据区域</li>
</ul>
</li>
</ul>
<h3 id="LIBNAME访问PC文件语法"><a href="#LIBNAME访问PC文件语法" class="headerlink" title="LIBNAME访问PC文件语法"></a>LIBNAME访问PC文件语法</h3><p><strong>LIBNAME</strong> &lt;<em>libref</em>&gt; &lt;<em>engine-name</em>&gt; &lt;<em>‘physical-path and filename.ext’</em>&gt; &lt;<em>SAS/ACCESS-engine-connection-options</em>&gt; &lt;<em>SAS/ACCESS LIBNAME-options</em>&gt;;</p>
<ul>
<li>libref: 逻辑库名，其实是存放数据表和视图的DBMS数据库、架构、服务器端别名</li>
<li>engine-name: 引擎名,不同的DMBS数据文件需要指定不同的引擎名，入oracle、db2等</li>
<li>‘physical-path and filename.ext’: PC数据文件地址，文件名以及扩展名，置于引号中</li>
<li>SAS/ACCESS 连接选项，常用的如用户名，密码等，不同的DMBS数据文件会有所不同</li>
<li>SAS／ACCESS 逻辑库选项，控制SAS处理DBMS对象的方式，不同的DBMS数据文件会有所不同</li>
</ul>
<p>⚠️SAS在读取Excel文件时，默认用前8行数据判定列的数据类型和长度。解决的办法是让SAS读入更多的数据行再确定数据类型，然而SAS未为Excel提供这样的选项。可以修改Windows注册表的Excel的TypeGuessRows的值为0，这样SAS会在读入所有行后再确定变量的类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">filename myexcel &quot;D:\Data\Raw|class.xlsx&quot;;</div><div class="line">prco import</div><div class="line">    datafile=myexcel dbms=excel out=myxls replace;</div><div class="line">range=&quot;&apos;sheet1$A1:E20&apos;n&quot;; ／*读入sheet1的A1-E20区域数据*／</div><div class="line">getnames=yes;</div><div class="line">run;</div><div class="line">proc import</div><div class="line">    datafile=myexcel dbms=excel out=myxls replace;</div><div class="line">dbdsopts=&quot;firstobs=3 obs=8&quot;; /*读入sheet1的3-8行区域数据*/</div><div class="line">getnames=yes;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="读入CSV文件"><a href="#读入CSV文件" class="headerlink" title="读入CSV文件"></a>读入CSV文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">filename mycsv &quot;D:\Data\Raw|class.csv&quot;;</div><div class="line">proc import </div><div class="line">    datafile=mycsv dbms=csv out=tmp replace;</div><div class="line">getnames=yes;</div><div class="line">guessingrows=20; /*通过前20行确定变量类型*/</div><div class="line">datarow=2; /*数据从第二行开始*/</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="读入TXT特殊字符分隔的文件"><a href="#读入TXT特殊字符分隔的文件" class="headerlink" title="读入TXT特殊字符分隔的文件"></a>读入TXT特殊字符分隔的文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">filename mytxttab &quot;D:\Data\Raw|class_tab.txt&quot;</div><div class="line">filename mytxtblk &quot;D:\Data\Raw|class_blk.txt&quot;</div><div class="line">proc import</div><div class="line">    datafile=mytxttab dbms=dlm out=tmp replace;</div><div class="line">delimiter=&apos;09&apos;x;</div><div class="line">getnames=yes;</div><div class="line">run;</div><div class="line">proc import</div><div class="line">    datafile=mytxtblk dbms=dlm out=tmp replace;</div><div class="line">delimiter=&apos;20&apos;x;</div><div class="line">getnames=yes;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="INPUT语句列表读入式"><a href="#INPUT语句列表读入式" class="headerlink" title="INPUT语句列表读入式"></a>INPUT语句列表读入式</h3><p>适合数据不齐整</p>
<p><strong>INPUT</strong> &lt;<em>pointer-control</em>&gt; variable &lt;$&gt; &lt;:|$|~&gt; &lt;<em>informat.</em>&gt; <a href="&#x6d;&#x61;&#105;&#108;&#x74;&#111;&#58;&#64;&#x7c;&#x40;&#x40;">&#64;&#x7c;&#x40;&#x40;</a>;</p>
<ul>
<li>pointer-control: 控制变量读入点起始位置。针对行: #, /。针对列: @, +。</li>
<li>variable: 变量列表</li>
<li>$: 变量类型为字符型</li>
<li>:|$|~: 三个互斥点可选用格式修饰符<ul>
<li>: 读入点变量列上不齐整，读到空列、读完字符定义的长度或者数据行结尾时就算一个变量读完</li>
<li>&amp; 读入点字符变量包含不连续的空格</li>
<li>~ 读入其他分隔符分隔数据，字符变量引号，引号里有分隔符</li>
</ul>
</li>
<li>informat.: 输入格式<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">data tmp;</div><div class="line">input name : $13. gender $ age location $; /*:表示遇到空格或第13列，才读完name*/</div><div class="line">datalines;</div><div class="line">WYY M 25 Shanghai</div><div class="line">WuYuanyi M 25 Shanghai</div><div class="line">StatsThinking M 1 Beijing</div><div class="line">;</div><div class="line">run;</div><div class="line"></div><div class="line">data tmp;</div><div class="line">input name &amp; $9. gender $ age location $; /*一个空格不会认为变量结束*/</div><div class="line">datalines;</div><div class="line">W YY  M 25 Shanghai</div><div class="line">Wu Yuanyi  M 25 Shanghai</div><div class="line">;</div><div class="line">run;</div><div class="line"></div><div class="line">data tmp;</div><div class="line">infile datalines delimiter=&apos;,&apos;;</div><div class="line">input name &amp; $9. gender $ age location $ affiliation ~ $12.;</div><div class="line">datalines;</div><div class="line">YY WU,M,30,Shanghai,&quot;SHTU,SSIT&quot;</div><div class="line">Yuanyi Wu,M,30,Shanghai,&quot;SHTU,SSIT&quot;</div><div class="line">run;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="INPUT语句列读入式"><a href="#INPUT语句列读入式" class="headerlink" title="INPUT语句列读入式"></a>INPUT语句列读入式</h3><p>适合数据齐整的情况</p>
<p><strong>INPUT</strong> variable&lt;$&gt; start-column&lt;-end-column&gt; &lt;.decimals&gt; <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#x40;&#124;&#64;&#64;">&#x40;&#124;&#64;&#64;</a>;</p>
<ul>
<li>start-column&lt;-end-column&gt;: 变量读入点起止列</li>
<li>.decimals: 小数位数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">data tmp;</div><div class="line">input name $ 1-9 gender $ 11 age 13-14 location $ 16-23;</div><div class="line">YY Wu     M 25 Shanghai</div><div class="line">Yuanyi Wu M 25 Shanghai</div><div class="line">;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="INPUT语句格式读入式"><a href="#INPUT语句格式读入式" class="headerlink" title="INPUT语句格式读入式"></a>INPUT语句格式读入式</h3><p>可以对字符变量指定宽度，以及读入非标准形式对数字，如科学计数法、带货币符号、带千分位等。</p>
<p><strong>INPUT</strong> &lt;<em>pointer-control</em>&gt; <em>variable</em> <em>informat.</em> <a href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#58;&#64;&#x7c;&#64;&#x40;">&#64;&#x7c;&#64;&#x40;</a>;<br><strong>INPUT</strong> &lt;<em>pointer-control</em>&gt; (<em>variable-list</em>) (<em>informat-list</em>) <a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#x6f;&#x3a;&#x40;&#x7c;&#64;&#x40;">&#x40;&#x7c;&#64;&#x40;</a>;<br><strong>INPUY</strong> &lt;<em>pointer-control</em>&gt; (<em>variable-list</em>) (&lt;<em>n</em>&gt; informat.) <a href="&#x6d;&#97;&#x69;&#x6c;&#x74;&#x6f;&#x3a;&#x40;&#x7c;&#64;&#x40;">&#x40;&#x7c;&#64;&#x40;</a>;</p>
<ul>
<li>(variable-list) (informat-list): 变量格式列表<ul>
<li>编号范围列表：形如x1,x2,x3可缩写为x1-xn</li>
<li>名称范围列表：x–a定义顺序从x到a的所有变量，x-numeric-a为x到a的所有数值型变量，x-character-ax到a的所有字符型变量</li>
<li>名称前缀列表：如x_1,x_2或x1,X2可简写成x:</li>
<li>特殊SAS名列表：_numerica_, _character_, _all_</li>
</ul>
</li>
<li>&lt;<em>n</em>&gt; informat.: 变量格式列表n表示格式重复的次数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">data tmp;</div><div class="line">/*gender虽然只有1列，但声明时要带上其后的一个空格，age，location类似*/</div><div class="line">input name &amp; $10. gender $2. age 3. location $8. fee comma6.;</div><div class="line">datalines;</div><div class="line">YY Wu  M 25 Shanghai 12,345</div><div class="line">Yuanyi Wu  M 25 Shanghai 54,321</div><div class="line">;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="INPUT语句命名读入式"><a href="#INPUT语句命名读入式" class="headerlink" title="INPUT语句命名读入式"></a>INPUT语句命名读入式</h3><p><strong>INPUT</strong> &lt;<em>pointer-control</em>&gt; variable= &lt;$&gt; <a href="&#109;&#x61;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#64;&#124;&#64;&#x40;">&#64;&#124;&#64;&#x40;</a>;<br><strong>INPUT</strong> &lt;<em>pointer-control</em>&gt; variable= informat. <a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#111;&#58;&#64;&#124;&#x40;&#64;">&#64;&#124;&#x40;&#64;</a>;<br><strong>INPUT</strong> variable= &lt;$&gt; start-column&lt;-end-column&gt; &lt;.decimals&gt; <a href="&#x6d;&#97;&#105;&#x6c;&#116;&#111;&#58;&#64;&#x7c;&#x40;&#x40;">&#64;&#x7c;&#x40;&#x40;</a>;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">data tmp;</div><div class="line">input name= $ gender= $ age= location=$;</div><div class="line">datalines;</div><div class="line">name=WYY gender=M age=25 location=Shanghai</div><div class="line">name=GY gender=F age=24 location=Shanghai</div><div class="line">;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="数据导出"><a href="#数据导出" class="headerlink" title="数据导出"></a>数据导出</h3><p><strong>PROC EXPORT DATA</strong>=&lt;<em>libref.</em>&gt;<em>SAS data set</em>&lt;(<em>SAS data set options</em>)&gt;</p>
<p><strong>OUTFILE</strong>=”filename”|<strong>OUTTABLE</strong>=”tablename”</p>
<p>&lt;DBMS=data-source-identifier\&gt;</p>
<p>&lt;LABEL&gt;</p>
<p>&lt;REPLACE&gt;</p>
<p>&lt;file-format-specific-statements&gt;;</p>
<p><strong>RUN</strong>;</p>
<ul>
<li>SAS data set: 欲输出的数据集</li>
<li>filename|tablename: 输出文件的地址名称</li>
<li>LABEL: 输出文件中输出变量名的标签</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">proc export</div><div class="line">    data=sashelp.class outfile=&apos;D:\Data\Raw|class.xlsx&apos;</div><div class="line">    dbms=excel replace;</div><div class="line">run;</div><div class="line"></div><div class="line">proc export</div><div class="line">    data=sashelp.class outfile=&apos;D:\Data\Raw|class_tab.txt&apos;</div><div class="line">    dbms=csv replace delimiter=&apos;09&apos;x;</div><div class="line">run;</div></pre></td></tr></table></figure>
<hr>
<h2 id="行舟来去泛纵横：变量观测"><a href="#行舟来去泛纵横：变量观测" class="headerlink" title="行舟来去泛纵横：变量观测"></a>行舟来去泛纵横：变量观测</h2><h3 id="DATA-SET语句"><a href="#DATA-SET语句" class="headerlink" title="DATA+SET语句"></a>DATA+SET语句</h3><p><strong>DATA</strong> &lt;<em>data-set-name-1</em> &lt;<em>data-set-options-1</em>&gt;&gt;  &lt;…<em>data-set-name-n</em> &lt;<em>data-set-options-n</em>&gt;&gt; &lt;/&lt;DEBUG&gt; &lt;NESTING&gt; &lt;STACK = <em>stack-size</em>&gt;&gt; &lt;NOLIST&gt;;</p>
<p><strong>DATA</strong> _NULL_ &lt;/&lt;DEBUG&gt; &lt;NESTING&gt; &lt;STACK = <em>stack-size</em>&gt;&gt; &lt;NOLIST&gt;;</p>
<ul>
<li>data-set-name: 欲创建的SAS数据集名</li>
<li>data-set-options: 欲创建的SAS数据集的限制选项</li>
<li>DEBUG: 调试程序逻辑错误以及部分数据错误</li>
<li>NESTING: 日志中标记DO-END和SELECT-END语句的起止</li>
<li>STACK =: 可嵌套LINK语句个数</li>
<li>NOLIST: 出错时不在日志打印每个变量的值</li>
<li>_NULL_: 不建任何SAS数据集</li>
</ul>
<h3 id="获取背后数据"><a href="#获取背后数据" class="headerlink" title="获取背后数据"></a>获取背后数据</h3><ol>
<li>利用<code>OSD TRACE ON</code>和<code>ODS TRACE OFF</code>对整个统计过程进行全程追踪和监控：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ods trace on;</div><div class="line">proc lifetest data=sashelp.bmt;</div><div class="line">    time t*status(0);</div><div class="line">    strata group;</div><div class="line">run;</div><div class="line">ods trace off;</div></pre></td></tr></table></figure>
<ol>
<li>在LOG文件中，产生的结果一目了然，想要什么数据随意抓取。</li>
<li><code>ODS OUTPUT</code>语句抓取Result树形目录下结果：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ods output SurvialPlot=SurvPlotData;</div><div class="line">proc lifetset data=sashelp.bmt;</div><div class="line">    time t*status(0);</div><div class="line">    strata group;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="IF与WHERE"><a href="#IF与WHERE" class="headerlink" title="IF与WHERE"></a>IF与WHERE</h3><ol>
<li>WHERE更高效。WHERE语句在读入PDV之前就先行判断，求子集IF语句先读入观测进入PDV，而后再判断。</li>
<li>WHERE更广泛。WHERE语句可用在DATA步，PROC步，作为数据集选项使用。IF语句只能作为DATA步语句使用。</li>
<li>IF语句对INPUT语句创建的观测有效，WHERE语句只能筛选数据集里的观测。</li>
<li>当有BY语句时，求子集IF语句与WHERE语句结果可能不同，因为SAS创建BY组再WHERE语句之后，求子集IF语句之前。</li>
<li>求自己IF语句可以用在条件IF语句中，WHERE语句不行</li>
<li>当读入多个数据集时，WHERE语句可以针对每个数据集单独筛选，求子集IF语句不行。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">/*打开数据集时，直接读取只需要的观测：通过WHERE选项限定读入数据集*/</div><div class="line">data tmp;</div><div class="line">    set sashelp.class(where=(sex=&quot;F&quot;));</div><div class="line">run;</div><div class="line"></div><div class="line">/*PDV里筛选过滤观测*/</div><div class="line">/*通过WHERE语句*/</div><div class="line">data tmp;</div><div class="line">    set sashelp.class;</div><div class="line">    where sex=&quot;F&quot;;</div><div class="line">run;</div><div class="line">/*通过求子集IF语句*/</div><div class="line">data tmp;</div><div class="line">    set sashelp.class;</div><div class="line">    if sex=&quot;F&quot;;</div><div class="line">run;</div><div class="line">/*只写入所需观测进入数据集：通过WHERE选项限定输出数据集*/</div><div class="line">data tmp(where=(sex=&quot;F&quot;));</div><div class="line">    set sashelp.class;</div><div class="line">run;</div><div class="line"></div><div class="line">data want(where=(not missing(id)));</div><div class="line">    set raw1(where=(age between 20 and 30)) raw2(where=(sex=&quot;F&quot;));</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="KEEP、DROP与RENAME"><a href="#KEEP、DROP与RENAME" class="headerlink" title="KEEP、DROP与RENAME"></a>KEEP、DROP与RENAME</h3><ol>
<li>选项只作用于被其尾随的数据集，而语句作用域PDV，即语句对不管来自哪个数据集的变量都有效。</li>
<li>KEPP/DROP，RENAME，WHERE和其他语句的执行有固定的执行顺序。<ul>
<li>数据集读入和输出阶段的执行顺序：<ol>
<li>KEPP/DROP选项筛选变量</li>
<li>RENAME选项修改变量名</li>
<li>WHERE选项筛选观测</li>
</ol>
</li>
<li>编程处理阶段：<ol>
<li>WHERE选项筛选观测</li>
<li>其他执行语句</li>
<li>KEPP/DROP选项筛选变量</li>
<li>RENAME选项修改变量名</li>
</ol>
</li>
</ul>
</li>
</ol>
<h3 id="编译变量和临时变量"><a href="#编译变量和临时变量" class="headerlink" title="编译变量和临时变量"></a>编译变量和临时变量</h3><p>编译变量(NOBS、IN、OBS、END、POINT等)和临时变量的赋值方式是将等号左边赋值给等号右边，其他赋值语句是将等号左边赋值给右边，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">/*PROC SQL获取观测值 最慢*/</div><div class="line">proc sql;</div><div class="line">    select count(name) as N from sashelp.class;</div><div class="line">quit;</div><div class="line"></div><div class="line">/*_N_获取观测数 中*/</div><div class="line">data _null_;</div><div class="line">    set sashelp.class end=last;</div><div class="line">    if last then put _n_;</div><div class="line">run;</div><div class="line"></div><div class="line">/*编译变量获取观测数 最快*/</div><div class="line">data _null_;</div><div class="line">    if 0 then set sashelp.class nobs=n;</div><div class="line">    put _all_;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="CALL例程"><a href="#CALL例程" class="headerlink" title="CALL例程"></a>CALL例程</h3><p>CALL例程也可以生成新变量，这种方法是函数形式的一种变种。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">data rand;</div><div class="line">    seed=123;</div><div class="line">    do i=1 to 10;</div><div class="line">        x=rannor(seed);</div><div class="line">        call rannor(seed,y);</div><div class="line">        output;</div><div class="line">    end;</div><div class="line">run;</div><div class="line">proc print data=rand;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="变量类型转换"><a href="#变量类型转换" class="headerlink" title="变量类型转换"></a>变量类型转换</h3><p>new_variable = input(original_variable, informat.);</p>
<p>new_variable = put(original_variable, format.);</p>
<ul>
<li>new_variable：欲生成的新变量</li>
<li>informat.：变量输入格式</li>
<li>format.：变量输出格式</li>
</ul>
<h3 id="DATA步实现累加"><a href="#DATA步实现累加" class="headerlink" title="DATA步实现累加"></a>DATA步实现累加</h3><p>累加语句：variable+expression;</p>
<ul>
<li>variable：累加器变量，必须为数字型变量，累加后的值保存于此变量中</li>
<li>expression：表达式，表达式的值会被累加到累加器变量variable中</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">data want;</div><div class="line">    set sashelp.class;</div><div class="line">    cum_weight+weight;</div><div class="line">    cnt_weight+1;</div><div class="line">    avg_weight=cum_weight/cnt_weight;</div><div class="line">run;</div></pre></td></tr></table></figure>
<p>RETAIN语句：<strong>RETAIN</strong> &lt;<em>element-list(s)</em> &lt;<em>initial-value(s)</em>|(<em>initial-value-1</em>)|(<em>initial-value-list-1</em>)&gt; &lt;<em>…element-list-n</em> &lt;<em>initial-value-n</em>|(<em>initial-value-n</em>)|(<em>initial-value-list-n</em>)&gt;&gt;&gt;</p>
<ul>
<li>element-list：需要保留PDV里的值的参数，可以是变量名、变量列表、数组名</li>
</ul>
<ul>
<li>initial-value：初始值，对应于只有一个参数或者参数列表里的第一个参数</li>
<li>(initial-value-1)：带括号的初始值</li>
<li>(initial-value-list-1)：带括号的初始值列表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">data want;</div><div class="line">    set sashelp.class;</div><div class="line">    retain cum_weight cnt_weight (0 0);</div><div class="line">    cum_weight=cum_weight+weight;</div><div class="line">    cnt_weight=cnt_weight+1;</div><div class="line">    avg_weight=cum_weight/cnt_weight;</div><div class="line">run;</div></pre></td></tr></table></figure>
<p>BY语句的作用是在PROC SORT中排序后，在SET、MERGE、UPDATE以及MODIFY语句中，指定分组变量，产生临时变量FIRST.变量和LAST.变量用以标示观测变量是否为分组变量里的第一条和最后一条。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">proc sort data=sashelp.class out=class;</div><div class="line">    by sex;</div><div class="line">run;</div><div class="line">data want;</div><div class="line">    set class end=last;</div><div class="line">    by sex;</div><div class="line">    if first.sex then do;</div><div class="line">        cum_weight=0;</div><div class="line">        cnt_weight=0;</div><div class="line">    end;</div><div class="line">    cum_weight+weight;</div><div class="line">    cnt_weight+1;</div><div class="line">    if last.sex then do;</div><div class="line">        avg_weight=cum_weight/cnt_weight;</div><div class="line">        output;</div><div class="line">    end;</div><div class="line">run;</div></pre></td></tr></table></figure>
<h3 id="隔行取数据"><a href="#隔行取数据" class="headerlink" title="隔行取数据"></a>隔行取数据</h3><p>SAS DATA步是隔行处理数据，一旦一行处理完，读入下一行数据后，前面行的数据就不在PDV里了。</p>
<ul>
<li>LAG：把前面任一行的数据在取出来</li>
<li>DIF：计算目前行与前面任一行的差</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data want;</div><div class="line">    set sashelp.class;</div><div class="line">    /*前面2人是谁*/</div><div class="line">    pre1name=lag1(name);</div><div class="line">    pre2name=lag2(name);</div><div class="line">    /*与前面两人身高的差*/</div><div class="line">    dif1height=dif1(heigh);</div><div class="line">    dif2hegith=dif2(height);</div><div class="line">run;</div><div class="line">proc print&apos;</div><div class="line">run;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/08/02/black production survey/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/02/black production survey/" itemprop="url">网贷黑中介调研</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-02T09:31:44+08:00">
                2017-08-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近进入了互联网金融行业，继续做一些反欺诈相关的工作。知己知彼，百战不殆。</p>
<h1 id="网贷技术"><a href="#网贷技术" class="headerlink" title="网贷技术"></a>网贷技术</h1><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><h3 id="客户的详细版征信"><a href="#客户的详细版征信" class="headerlink" title="客户的详细版征信"></a>客户的详细版征信</h3><p>不查征信的小贷，另当别论。要求客户打印详细版征信；没有的话，一定要让客户如是交代最近的申请记录以及单位信息。</p>
<h3 id="删除贷款相关信息"><a href="#删除贷款相关信息" class="headerlink" title="删除贷款相关信息"></a>删除贷款相关信息</h3><ul>
<li>贷款App：删除客户手机里所有贷款相关的App</li>
<li>手机短信：删除所有信贷相关的短信，包括网贷平台的验证码、批准、被拒短信；信用卡催收短信，包括带有“如已还款请忽略”的。</li>
<li>通话记录：删除一切与信贷公司、银行相关的通话记录。更不可将号码保存到通讯录。</li>
<li>信用卡账单：删除逾期账单、未满六个月的信用卡的账单、非详版账单，只保留符合要求且用卡状况良好的账单。</li>
<li>淘宝交易记录：删除充值点卡、购买虚拟物品，非客户本人收货地址、收货人电话与申请人不一致的交易。</li>
</ul>
<h2 id="包装客户"><a href="#包装客户" class="headerlink" title="包装客户"></a>包装客户</h2><p>年龄、学历、单位、公积金、社保、征信情况、车贷、房贷、信用卡种类、贷款记录、打卡工资、是否有保单、实名制手机、芝麻分、电商账号。</p>
<ul>
<li>年龄：一般18-60周岁，大部分网贷已经限制到22-40周岁。</li>
<li>征信：纯白户或黑户，做黑白户小贷的口子。</li>
<li>信用卡：3-6月或以上的客户，大部分口子都可以操作。</li>
<li>账单：一些口子要6个月以上的连续账单，如叮当贷、爱钱进、宜人极速贷。</li>
<li>车贷、房贷：可以做易分期，也可以办卡。办卡的话，基本上都可以下。</li>
<li>保单：平安人寿的保单贷、太平洋的保单贷。</li>
<li>社保、公积金：有地区限制，51公积金app，宜人贷公积金模式、网易小贷。</li>
<li>学历：浦发青春贷、闪银，交通、光大办信用卡。</li>
<li>在校大学生：本科学历可以做10-50万贷款。</li>
</ul>
<h2 id="贷款实操"><a href="#贷款实操" class="headerlink" title="贷款实操"></a>贷款实操</h2><ul>
<li>单位好直接使用，无单位就要包装单位。</li>
<li>做工牌认证、银行流水账单。</li>
<li>培训客户，做好回访。</li>
<li>坐等下款，收钱。</li>
</ul>
<h2 id="申请贷款的10个细节"><a href="#申请贷款的10个细节" class="headerlink" title="申请贷款的10个细节"></a>申请贷款的10个细节</h2><ul>
<li>实名制手机：每个月必须有通话记录，证明这个电话是经常使用的。</li>
<li>联系人：必须能在最近通话记录中找到的联系人。</li>
<li>工作信息：很多网贷会共享资料，因此工作信息不要经常换，最好提供一年以上的。如果没有工作，自己准备一个固话，搜索附近的公司（网上没电话的那种），用这家公司的名字在网上发布招聘信息，留下准备的固化。当然工作合同证明也可以这样。</li>
<li>信用卡账单邮箱：账单必须连续多月，若有多张信用卡，保留信用最好的一张卡就行。</li>
<li>阿里系验证：淘宝支付宝一定要实名验证，最近两个月一定要有实物消费记录。保留一个常用地址，其他全部删除。</li>
<li>工作证明、名片、工牌：</li>
<li>回访电话：一定要接到电话，有的网贷公司两次没接到就会直接拒。回答问题一定不要犹豫，必须和资料相符。</li>
<li>回访联系人：回访联系人的网贷不是很急不用去申请。申请前对手机里的联系人进行整理，并提前打好招呼。</li>
<li>回访内容<ul>
<li>父母：</li>
<li>公司：本人接最好，本人没接到，一定要让接电话的人说是单位电话。</li>
<li>配偶：一定是本人接听，不是本人则100%拒贷。</li>
<li>申请人：聊工作，聊生活，也可以反问能否批，什么时候批。</li>
</ul>
</li>
<li>信用卡回访<ul>
<li>资料写小纸条上，随身携带以免忘记。</li>
<li>不清楚如何回答时，借口信号不好，过几分钟再打来，趁机熟悉资料。</li>
<li>卡片寄哪里？一定要寄往资料上的公司或住址。</li>
<li>要和申卡时填写的联系人提前说明，以免挂掉。</li>
<li>问认识单位谁谁谁时，若不认识，可回答“或许有，公司人多不熟悉”。</li>
</ul>
</li>
</ul>
<h2 id="不上征信的小贷"><a href="#不上征信的小贷" class="headerlink" title="不上征信的小贷"></a>不上征信的小贷</h2><p>宜人贷、功夫贷、拍拍贷、信用钱包、发薪贷、现金巴士、亲亲小贷、达飞云贷、手机贷、小花钱包贷、闪电借款、用钱宝、你我贷、指尖贷、曹操贷、积木盒子、麦芽贷、闪银、名校贷、神灯小贷、玖富叮当贷、么么贷、魔法现金、给你花、屌丝贷、51人品贷、融360、月光足</p>
<h2 id="上征信的贷款"><a href="#上征信的贷款" class="headerlink" title="上征信的贷款"></a>上征信的贷款</h2><p>微粒贷(深圳前海微众银行)、借呗(网商贷)、捷信(中银、北银、马上)、消费金融、佰仟金融(哈尔滨银行)、省呗(包商银行)、拉卡拉、卡卡贷、贷款王、证大、中安信业、平安、布丁小贷、豆豆钱、唯信旗下系列产品、信而富现金贷、马上金融、安逸花</p>
<h2 id="不查征信的网贷"><a href="#不查征信的网贷" class="headerlink" title="不查征信的网贷"></a>不查征信的网贷</h2><p>手机贷、发薪贷、信用钱包、现金巴士、拍拍贷、人人贷、信闪贷、用钱宝、鼎及贷、mo9、曹操贷、亲亲小贷、原子贷、闪银、嗨秒贷、闪电借款、钱站、读秒、我来贷、指尖贷、小花钱包、小米金融、么么贷、魔法现金贷、给你花、趣借吧、玖富叮当贷、功夫贷、达飞云贷、51人品贷、58消费金融、融360、月光足、信而富现金贷</p>
<h2 id="无视黑白的贷款"><a href="#无视黑白的贷款" class="headerlink" title="无视黑白的贷款"></a>无视黑白的贷款</h2><p>拍拍贷、现金巴士、手机贷、马上金融、父母贷、发薪贷、闪银奇异、平安普惠、我来贷、给你花、信闪贷、贷款王、用钱宝、鼎及贷、mo9、曹操贷、亲亲小贷、原子贷、嗨秒贷、微信马上贷</p>
<h2 id="信用卡口子"><a href="#信用卡口子" class="headerlink" title="信用卡口子"></a>信用卡口子</h2><p>卡卡贷、闪电借款、钱站、宜人贷、省呗、积木盒子、读秒贷、你我贷-嘉卡贷、功夫贷、51人品贷、小赢卡贷、还呗</p>
<h2 id="公积金口子"><a href="#公积金口子" class="headerlink" title="公积金口子"></a>公积金口子</h2><ul>
<li>江苏银行app：金E融 (地区限制：江苏)</li>
<li>51公积金app：很多公积金贷款通道</li>
<li>网易小贷：微信关注</li>
<li>你我贷app：嘉英贷</li>
<li>宜人贷app：公积金模式</li>
<li>中信银行公积金贷款：网银申请，公积金缴存两年以上</li>
<li>有鱼公积金app：公积金缴存6个月以上</li>
</ul>
<p>防止银行降额封卡和冻结的方法：</p>
<ul>
<li>预约分期(打电话给银行客服，这比消费预约3-6期的分期)</li>
<li>全额还款<ul>
<li>账单日和最后还款日的修改功能</li>
<li>最后还款日后已经开始收利息了</li>
<li>免息天数 = (最后还款日 - 账单日)[20天] + 银行宽限期限[2-3天]</li>
</ul>
</li>
<li>选择五台不同商户的POS机(一机一码)，五台一组，一天两到三次，循环的刷出来再循环的还进去。分10笔或者11笔，周期为10天。最后还款日前三天完成。甚至有可能提升额度。</li>
</ul>
<p>消除不良记录</p>
<ul>
<li>银行有征信更新的权限</li>
<li>银行权限内，自己都可以处理</li>
<li>银行权限外，谁都不行</li>
</ul>
<p>三类人群</p>
<ul>
<li>有信用卡，有申请记录，征信报告有记录</li>
<li>有在银行递交过申请资料</li>
<li>三无人员，无向银行递交申请资料，无网贷</li>
</ul>
<h2 id="中国建设银行"><a href="#中国建设银行" class="headerlink" title="中国建设银行"></a>中国建设银行</h2><h3 id="优质客户办卡"><a href="#优质客户办卡" class="headerlink" title="优质客户办卡"></a>优质客户办卡</h3><ol>
<li>申请一张建设银行龙腾理财金卡(要求开通网银，获得U盾、密码器)<ul>
<li>功能：贷卡合一、理财、储蓄</li>
<li>条件：存五万</li>
<li>漏洞：小城市小网点可以免费办理</li>
</ul>
</li>
<li>把所有钱都集中到建设银行</li>
<li>购买建设银行的理财(速盈理财)</li>
<li>购买速盈理财7天，产生一个周期的收益。7天后收到短信“您是我行理财优质客户，邀请申请龙卡JOY”。如果没有收到短信，把理财的钱取出来，再买一个周期。</li>
</ol>
<h3 id="建设银行代发工资、团办申卡"><a href="#建设银行代发工资、团办申卡" class="headerlink" title="建设银行代发工资、团办申卡"></a>建设银行代发工资、团办申卡</h3><h4 id="有公司的人-代发工资业务"><a href="#有公司的人-代发工资业务" class="headerlink" title="有公司的人[代发工资业务]"></a>有公司的人[代发工资业务]</h4><ul>
<li>条件<ul>
<li>必须有公司正常营业，正常注册时间越久越好</li>
<li>人数：30人左右(各地人数不一样)</li>
<li>被代发人必须在建设银行具有储蓄卡</li>
<li>代发金额：3600 - 8000</li>
<li>代发时间：6-12个月</li>
<li>每月代发时间：给员工发工资的前一天，把代发的钱打入银行代发账号</li>
<li>代发费用：建设银行每个人4-5元</li>
</ul>
</li>
<li>申请代发金额的1.5-2倍的信用卡。10个人，每人代发3600，下个月每人可申请3万的信用卡。公司就有30万可以使用。</li>
<li>工资袋最高额度30万</li>
</ul>
<h4 id="白户"><a href="#白户" class="headerlink" title="白户"></a>白户</h4><ul>
<li>众筹：筹人、筹资金、筹公司。然后按第一种方法。</li>
</ul>
<h3 id="有建设银行ETC信用卡的人"><a href="#有建设银行ETC信用卡的人" class="headerlink" title="有建设银行ETC信用卡的人"></a>有建设银行ETC信用卡的人</h3><p>区县换卡</p>
<h2 id="建设银行实操"><a href="#建设银行实操" class="headerlink" title="建设银行实操"></a>建设银行实操</h2><ol>
<li>下载中国建设银行客户端</li>
<li>绑定龙腾理财金卡的手机注册登陆</li>
<li>买入速盈理财7天，直到收到邀请短信。</li>
<li>信用卡管理页面中可以看到预审批额度查询。如果额度低，循环买卖理财。</li>
<li>信用卡管理页面中找到卡片推荐，35岁以下的龙卡JOY。</li>
</ol>
<h2 id="造假"><a href="#造假" class="headerlink" title="造假"></a>造假</h2><ul>
<li>工作<ul>
<li>挂靠熟人公司</li>
<li>自行挂靠：借助企信宝、天眼查</li>
</ul>
</li>
<li>座机<ol>
<li>找移动联通购买座机</li>
<li>招淘宝做彩铃</li>
<li>淘宝买座机绑定手机呼叫转移</li>
</ol>
</li>
<li>住宅<ul>
<li>借助58同城、赶集网</li>
</ul>
</li>
<li>控卡 异地挂靠申请</li>
</ul>
<h4 id="提额"><a href="#提额" class="headerlink" title="提额"></a>提额</h4><p>绑定建设银行的手机，打95533。转2号线，嘟一声立刻挂断。编辑短信<code>CCTE#卡号后四位#额度的两倍</code>发送到95533。</p>
<h3 id="交通银行第三次融资"><a href="#交通银行第三次融资" class="headerlink" title="交通银行第三次融资"></a>交通银行第三次融资</h3><ol>
<li>微信添加“交通银行信用卡|买单吧”公众号</li>
<li>点击“方便用”-“分期借款”-“好享贷”-“登录”</li>
<li>有缘分告诉你怎么刷爆好享贷<h3 id="怎么使用"><a href="#怎么使用" class="headerlink" title="怎么使用"></a>怎么使用</h3></li>
</ol>
<ul>
<li>分6-12期。分期越久，提额周期越久，风控风险越高。</li>
<li>3-5台pos机将固定额度刷出来；好享贷分到固定额度，再多笔刷出来</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/08/01/Event tracking/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/01/Event tracking/" itemprop="url">Event tracking</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-01T10:40:06+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="无埋点"><a href="#无埋点" class="headerlink" title="无埋点"></a>无埋点</h2><p>无埋点 = 可视化监测部署 = 所见即所得的监测部署</p>
<p>无论是监测网站，还是监测App，都必须加上监测代码或SDK，不加就搜集不到数据。</p>
<p>无论是埋点方法还是不埋点方法，要搜集数据都要加监测代码或SDK，称之为基础代码。要搜集到所有用户行为的数据，光有基础代码是不够的。无论是网站还是App(尤其是App)，总有一些特殊的用户操作行为时不能靠基础代码捕获的。</p>
<p>不能被基础代码捕获的用户操作行为，称为event(事件)。</p>
<ul>
<li>网页：Javascript、Flash、Silverlight、AJAX、各种页面插件的交互等等</li>
<li>App：包含用户点击在内的所有交互</li>
<li>凡是遵守http协议的交互（最典型的就是网页的链接），皆是可以由基础监测代码直接监测到数据的。</li>
<li>非http类型的用户交互，基础监测代码都无能为力。</li>
</ul>
<p>每一个需要监测的event互动，都被称为一个“监测点”。Web上需要的监测点较少，App上则布满了监测点。为了搜集这些监测点上的用户数据，必须部署上专用点事件监测代码(event tracking code)。</p>
<p><strong>事件监测(埋点)只有在基础代码工作的情况下才能发挥作用。</strong></p>
<p>机构为App配置无埋点监测点两种方法：</p>
<ul>
<li>手指取代鼠标，直接在手机上操作设置。</li>
<li>在电脑浏览器端操作，类似于一个模拟器。</li>
</ul>
<p><strong>全埋点</strong>：本质上和无埋点并无不同。因为无埋点就是直接对页面中所有的交互元素的用户行为进行监听。即使App或网页的开发者不需要监测点部分，无埋点也会将用户行为数据和对应的发生地信息照单全收。</p>
<p>无埋点和埋点点优劣对比</p>
<table>
<thead>
<tr>
<th style="text-align:left">优劣</th>
<th style="text-align:left">无埋点</th>
<th style="text-align:left">埋点</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">是否需要加基础代码</td>
<td style="text-align:left">要</td>
<td style="text-align:left">要</td>
</tr>
<tr>
<td style="text-align:left">事件监测部署简便性</td>
<td style="text-align:left">非常简便，业务人员可以轻松操作</td>
<td style="text-align:left">复杂，需要工程师帮助</td>
</tr>
<tr>
<td style="text-align:left">事件历史数据回溯</td>
<td style="text-align:left">可以回溯</td>
<td style="text-align:left">埋点前点数据不可以回溯</td>
</tr>
<tr>
<td style="text-align:left">事件的属性数据</td>
<td style="text-align:left">常见的无埋点方法基本不可以添加额外属性</td>
<td style="text-align:left">可添加或监测数个事件属性</td>
</tr>
<tr>
<td style="text-align:left">事件的分类报告</td>
<td style="text-align:left">常见的无埋点方法基本不可以实现分类报告</td>
<td style="text-align:left">可以实现事件的分类报告</td>
</tr>
<tr>
<td style="text-align:left">无明确发生地点的时间监测</td>
<td style="text-align:left">无法监测</td>
<td style="text-align:left">可以监测</td>
</tr>
</tbody>
</table>
<ul>
<li>用户的交互行为，如果没有具体的“地点”，无埋点方法不适用。如：用户上滑屏幕时，新内容瀑布流式的底部载入。这种交互没有一个明确的监测点位置，是不可见点。在可视化事件监测设置点界面上找不到这类交互。</li>
<li>可视化的无埋点部署，能够为交互行为设置的属性非常有限。一般无埋点部署，只能给交互行为起一个名字，然后机械的记录这个交互行为发生的次数。而埋点方法可以非常好的添加event背后的属性。</li>
<li>埋点方法因为带有多个属性，用户可以轻松的通过这些属性进行分类数据报告的读取。</li>
</ul>
<p><a href="http://www.docin.com/p-1531077573.html" target="_blank" rel="external">一种基于App的行为采集系统的设计与实现</a></p>
<h2 id="App行为数据"><a href="#App行为数据" class="headerlink" title="App行为数据"></a>App行为数据</h2><p>企业数据分为三类：</p>
<ul>
<li>企业内部的交易数据，特别是金融企业有丰富的交易数据</li>
<li>企业和用户之间的交互数据</li>
<li>第三方数据</li>
</ul>
<p>App行为数据特指用户在网站货App中浏览与点击等行为数据，主要用于统计分析App运营情况。用户在社交论坛互动也称为交互数据，此类交互数据在业务场景中更偏向客户关系管理与产品迭代货舆情监控。</p>
<p>App行为数据分为三个维度：</p>
<ul>
<li>时间<blockquote>
<p>某金融App中，正常交易行为数据流程时间在15秒左右，但部分设备的时间段却集中在2-3秒，明显属于非正常用户行为，通过特征分析针对流程时间段进行标签设置，有助于判断用户是否为欺诈行为。</p>
</blockquote>
</li>
<li>频次<blockquote>
<p>结合热力图了解产品体验和客户需求，同时也可以用来优化App内部的布局和销售关联产品。<br>频次数据经过进一步分析后可转化为趋势数据，这些数据痛产品转化和客户购买行为具有强相关关系。</p>
</blockquote>
</li>
<li>结果标签<blockquote>
<p>主要关注是否完成交易，用于判断客户点击浏览的结果。结果数据分为成交和不成交。成交数据可以用于产品体验分析，客户体验分析，渠道ROI分析；不成交数据可以用于二次营销。</p>
</blockquote>
</li>
</ul>
<p>| KPI | 维度标准|<br>| ：– | ：– |<br>| 访问次数 | 在一定时间范围内，所有的用户对App的使用次数|<br>| UV(独立访客) | 在指定时间段内不重复(仅计数一次)的访问者人数 |<br>| PV(浏览量) | App界面的浏览量，用户每次进入界面即被计数一次 |<br>| 访问深度 | 用户每次使用App进入的界面层数 |<br>| 停留时间 | 用户对App中各界面访问的时长 |<br>| 跳出率 | 单界面访问次数占总访问次数多百分比 |</p>
<p>用户对于某界面：停留时间 = 进入时间 - 离开时间</p>
<p>在App端，同一时间只能展示一个界面，故根据这些时间可以推算出用户的界面访问路径。</p>
<ol>
<li>App用户使用手机App，产生用户行为，App中行为采集功能根据用户行为的类型采用不同的函数对用户行为进行采集，然后将采集到的数据以二进制文本形式暂存到手机中；</li>
<li>App读取暂存数据文件，对数据进行合并去冗余处理后，采用一定策略集中发送到后端行为采集服务器；</li>
<li>采集服务器对行为数据进行拆解，根据数据的类型和时间，将数据保存到不同的日志服务器中；</li>
<li>日志分析服务器定期抓取数据进行分析，产生分析结果；</li>
<li>Web服务器读取分析结果，生成图表以供展示；</li>
</ol>
<ul>
<li>提供类库供App调用</li>
<li>提供用户行为的记录函数<ul>
<li>记录用户基本信息</li>
<li>记录用户进入、退出界面时页面驻留时间</li>
<li>记录用户进行特定操作时的特定事件</li>
</ul>
</li>
<li>提供数据暂存机制</li>
<li>提供数据发送策略</li>
<li>提供数据接收拆解存储功能</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/08/01/mySQL grammar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/01/mySQL grammar/" itemprop="url">MySQL grammer</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-01T10:13:36+08:00">
                2017-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SQL基础"><a href="#SQL基础" class="headerlink" title="SQL基础"></a>SQL基础</h1><h2 id="Select"><a href="#Select" class="headerlink" title="Select"></a>Select</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> column1, column2, ... </div><div class="line"><span class="keyword">from</span> table_name;</div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table_name;</div></pre></td></tr></table></figure>
<h2 id="Distinct"><a href="#Distinct" class="headerlink" title="Distinct"></a>Distinct</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> column1, column2, ... </div><div class="line"><span class="keyword">from</span> table_name;</div></pre></td></tr></table></figure>
<h2 id="Where"><a href="#Where" class="headerlink" title="Where"></a>Where</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> column1, column2, ... </div><div class="line"><span class="keyword">from</span> table_name </div><div class="line"><span class="keyword">where</span> condition;</div></pre></td></tr></table></figure>
<h2 id="And-Or-Not"><a href="#And-Or-Not" class="headerlink" title="And , Or, Not"></a>And , Or, Not</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> column1, column2, ... </div><div class="line"><span class="keyword">from</span> table_name </div><div class="line"><span class="keyword">where</span> condition1 <span class="keyword">and</span> condition2 <span class="keyword">and</span> condition3 ...;</div><div class="line"></div><div class="line"><span class="keyword">select</span> column1, column2, ... </div><div class="line"><span class="keyword">from</span> table_name </div><div class="line"><span class="keyword">where</span> condition1 <span class="keyword">or</span> condition2 <span class="keyword">or</span> condition3 ...;</div><div class="line"></div><div class="line"><span class="keyword">select</span> column1, column2, ... </div><div class="line"><span class="keyword">from</span> table_name </div><div class="line"><span class="keyword">where</span> <span class="keyword">not</span> condition;</div></pre></td></tr></table></figure>
<h2 id="Order-By"><a href="#Order-By" class="headerlink" title="Order By"></a>Order By</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> column1, column2, ... </div><div class="line"><span class="keyword">from</span> table_name </div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> column1, column2, ... <span class="keyword">ASC</span>|<span class="keyword">DESC</span>;</div></pre></td></tr></table></figure>
<h2 id="Insert-Into"><a href="#Insert-Into" class="headerlink" title="Insert Into"></a>Insert Into</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name </div><div class="line"><span class="keyword">values</span> (value1, value2, value3, ...);</div><div class="line"></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name (column1, column2, column3, ...) </div><div class="line"><span class="keyword">values</span> (value1, value2, value3, ...);</div></pre></td></tr></table></figure>
<h2 id="Null-Values"><a href="#Null-Values" class="headerlink" title="Null Values"></a>Null Values</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> column_names</div><div class="line"><span class="keyword">from</span> table_name</div><div class="line"><span class="keyword">where</span> column_name <span class="keyword">is</span> <span class="literal">null</span>;</div><div class="line"></div><div class="line"><span class="keyword">select</span> column_names</div><div class="line"><span class="keyword">from</span> table_name</div><div class="line"><span class="keyword">where</span> column_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</div></pre></td></tr></table></figure>
<h2 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">update</span> table_name </div><div class="line"><span class="keyword">set</span> column1 = value1, column2 = value2, ... </div><div class="line"><span class="keyword">where</span> condition;</div></pre></td></tr></table></figure>
<h2 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">delete</span> <span class="keyword">from</span> table_name </div><div class="line"><span class="keyword">where</span> condition;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/04/16/利用python 3进行数据分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/16/利用python 3进行数据分析/" itemprop="url">利用python 3.6进行数据分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-16T19:14:54+08:00">
                2017-04-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="环境部署"><a href="#环境部署" class="headerlink" title="环境部署"></a>环境部署</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">pip3 install numpy</div><div class="line">pip3 install scipy</div><div class="line">pip3 install pandas</div><div class="line">pip3 install matplotlib</div></pre></td></tr></table></figure>
<h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy, matplotlib</div><div class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> pet</div><div class="line">plt.plot(numpy.arange(<span class="number">10</span>))</div><div class="line">plt.show()</div></pre></td></tr></table></figure>
<h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> scipy</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> json</div><div class="line"></div><div class="line">records = [json.loads(line) <span class="keyword">for</span> line <span class="keyword">in</span> open(path)]</div><div class="line">time_zones = [rec[<span class="string">'tz'</span>] <span class="keyword">for</span> rec <span class="keyword">in</span> records <span class="keyword">if</span> <span class="string">'tz'</span> <span class="keyword">in</span> rec]</div><div class="line"></div><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_counts2</span><span class="params">(sequence)</span>:</span></div><div class="line">    counts = defaultdict(int)</div><div class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> sequence:</div><div class="line">        counts[x] +=<span class="number">1</span></div><div class="line">    <span class="keyword">return</span> counts</div><div class="line"><span class="comment"># sequence=[0,0,0,0,1,1,1,1,1]</span></div><div class="line"><span class="comment"># d = get_counts2(sequence)</span></div><div class="line"><span class="comment"># &gt;&gt;&gt; defaultdict(int, &#123;0: 4, 1: 5&#125;)</span></div><div class="line"><span class="comment"># dcit(d.items())</span></div><div class="line"><span class="comment"># &gt;&gt;&gt; &#123;0: 4, 1: 5&#125;</span></div><div class="line"></div><div class="line">counts = get_counts(time_zones)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">top_counts</span><span class="params">(count_dcit, n=<span class="number">10</span>)</span>:</span></div><div class="line">   value_key_pairs = [(count, tz) <span class="keyword">for</span> tz, count <span class="keyword">in</span> count_dict.items()]</div><div class="line">   value_key_pairs.sort()</div><div class="line">   <span class="keyword">return</span> value_key_pairs[-n:]</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/04/11/happybase/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/11/happybase/" itemprop="url">Start with happybase on Mac</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-11T16:59:37+08:00">
                2017-04-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="JDK"><a href="#JDK" class="headerlink" title="JDK"></a>JDK</h1><p>You have Java and the latest JDK on your OS X system.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew cask install Java</div></pre></td></tr></table></figure></p>
<h1 id="Install-and-config-hadoop"><a href="#Install-and-config-hadoop" class="headerlink" title="Install and config hadoop"></a>Install and config hadoop</h1><h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install hadoop</div></pre></td></tr></table></figure>
<h2 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h2><h3 id="Edit-hadoop-env-sh"><a href="#Edit-hadoop-env-sh" class="headerlink" title="Edit hadoop-env.sh"></a>Edit hadoop-env.sh</h3><p>The file can be located at <strong>/usr/local/Cellar/hadoop/2.7.3/libexec/etc/hadoop/hadoop-env.sh</strong> where 2.7.3 is the hadoop version.</p>
<p>Find the line with<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export HADOOP_OPTS=&quot;$HADOOP_OPTS -Djava.net.preferIPv4Stack=true&quot;</div></pre></td></tr></table></figure></p>
<p>and change it to<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export HADOOP_OPTS=&quot;$HADOOP_OPTS -Djava.net.preferIPv4Stack=true -Djava.security.krb5.realm= -Djava.security.krb5.kdc=&quot;</div></pre></td></tr></table></figure></p>
<h3 id="Edit-Core-site-xml"><a href="#Edit-Core-site-xml" class="headerlink" title="Edit Core-site.xml"></a>Edit Core-site.xml</h3><p>The file can be located at <strong>/usr/local/Cellar/hadoop/2.7.3/libexec/etc/hadoop/core-site.xml</strong> .</p>
<p>Edit configuration at last.<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>/usr/local/Cellar/hadoop/hdfs/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>A base for other temporary directories.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.default.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://localhost:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="Edit-hdfs-site-xml"><a href="#Edit-hdfs-site-xml" class="headerlink" title="Edit hdfs-site.xml"></a>Edit hdfs-site.xml</h3><p>The file can be located at <strong>/usr/local/Cellar/hadoop/2.7.3/libexec/etc/hadoop/mapred-site.xml</strong> and by default will be blank. You can copy and change mapred-site.xml.template.<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapred.job.tracker<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>localhost:9010<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="Edit-hdfs-site-xml-1"><a href="#Edit-hdfs-site-xml-1" class="headerlink" title="Edit hdfs-site.xml"></a>Edit hdfs-site.xml</h3><p>The file can be located at <strong>/usr/local/Cellar/hadoop/2.7.3/libexec/etc/hadoop/hdfs-site.xml</strong> .</p>
<p>Edit configuration at last<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="Alias"><a href="#Alias" class="headerlink" title="Alias"></a>Alias</h3><p>To simplify life edit your ~/.bash_profile using vim and add the following two commands.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">alias hstart=&quot;/usr/local/Cellar/hadoop/2.6.0/sbin/start-dfs.sh;/usr/local/Cellar/hadoop/2.6.0/sbin/start-yarn.sh&quot;</div><div class="line">alias hstop=&quot;/usr/local/Cellar/hadoop/2.6.0/sbin/stop-yarn.sh;/usr/local/Cellar/hadoop/2.6.0/sbin/stop-dfs.sh&quot;</div></pre></td></tr></table></figure></p>
<p>Edit your <em>~/.bashrc</em> or <em>~/.zshrc</em> using vim and add the following two commands<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">. ~/.bash_profile</div></pre></td></tr></table></figure></p>
<p>and excute<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ source ~/.bashrc</div><div class="line">$ source ~/.zshrc</div></pre></td></tr></table></figure></p>
<p>in the terminal to update.<br>Before we can run Hadoop we first need to format the HDFS using<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hdfs namenode -format</div></pre></td></tr></table></figure></p>
<h2 id="SSH-Localhost"><a href="#SSH-Localhost" class="headerlink" title="SSH Localhost"></a>SSH Localhost</h2><p>Nothing needs to be done here if you have already generated ssh keys. To verify just check for the existance of <em>~/.ssh/id_rsa</em> and the <em>~/.ssh/id_rsa.pub</em> files. If not the keys can be generated using<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ ssh-keygen -t rsa</div></pre></td></tr></table></figure></p>
<h3 id="Enable-Remote-Login"><a href="#Enable-Remote-Login" class="headerlink" title="Enable Remote Login"></a>Enable Remote Login</h3><p>“System Preferences” -&gt; “Sharing”. Check “Remote Login”</p>
<h3 id="Authorize-SSH-Keys"><a href="#Authorize-SSH-Keys" class="headerlink" title="Authorize SSH Keys"></a>Authorize SSH Keys</h3><p>To allow your system to accept login, we have to make it aware of the keys that will be used<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</div></pre></td></tr></table></figure></p>
<p>Let’s try to login.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ ssh localhost</div><div class="line">Last login: Fri Mar  6 20:30:53 2015</div><div class="line">$ exit</div></pre></td></tr></table></figure></p>
<h2 id="Running-Hadoop"><a href="#Running-Hadoop" class="headerlink" title="Running Hadoop"></a>Running Hadoop</h2><p>Now we can run Hadoop just by typing<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hstart</div></pre></td></tr></table></figure></p>
<p>and stopping using<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hstop</div></pre></td></tr></table></figure></p>
<h2 id="Good-to-know"><a href="#Good-to-know" class="headerlink" title="Good to know"></a>Good to know</h2><p>We can access the Hadoop web interface by connecting to<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Resource Manager: http://localhost:50070</div><div class="line">JobTracker: http://localhost:8088</div><div class="line">Specific Node Information: http://localhost:8042</div><div class="line"></div><div class="line">Command</div><div class="line">$ hstart</div><div class="line">$ jps </div><div class="line">32384 NameNode</div><div class="line">32712 ResourceManager</div><div class="line">32587 SecondaryNameNode</div><div class="line">32859 Jps</div><div class="line">32476 DataNode</div><div class="line">32812 NodeManager</div><div class="line"># hstop</div><div class="line"></div><div class="line">$ yarn  // For resource management more information than the web interface. </div><div class="line">$ mapred  // Detailed information about jobs</div></pre></td></tr></table></figure></p>
<h1 id="Install-zookeeper"><a href="#Install-zookeeper" class="headerlink" title="Install zookeeper"></a>Install zookeeper</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install zookeeper</div></pre></td></tr></table></figure>
<h1 id="Install-hbase"><a href="#Install-hbase" class="headerlink" title="Install hbase"></a>Install hbase</h1><h2 id="Install-1"><a href="#Install-1" class="headerlink" title="Install"></a>Install</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install hbase</div></pre></td></tr></table></figure>
<h2 id="Alias-1"><a href="#Alias-1" class="headerlink" title="Alias"></a>Alias</h2><p>To simplify life edit your ~/.bash_profile using vim and add the following two commands.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">alias hbstart=&quot;/usr/local/Cellar/hbase/1.2.2/bin/start-hbase.sh&quot;</div><div class="line">alias hbstop=&quot;/usr/local/Cellar/hbase/1.2.2/bin/stop-hbase.sh&quot;</div></pre></td></tr></table></figure></p>
<h2 id="Good-to-know-1"><a href="#Good-to-know-1" class="headerlink" title="Good to know"></a>Good to know</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$ hstart</div><div class="line">$ hbstart</div><div class="line">$ jps</div><div class="line">32384 NameNode</div><div class="line">33024 Jps</div><div class="line">32967 HMaster</div><div class="line">32712 ResourceManager</div><div class="line">32587 SecondaryNameNode</div><div class="line">32476 DataNode</div><div class="line">32812 NodeManager</div><div class="line">$ hbstop</div><div class="line">$ hstop</div></pre></td></tr></table></figure>
<h1 id="Install-happybase"><a href="#Install-happybase" class="headerlink" title="Install happybase"></a>Install happybase</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install happybase</div></pre></td></tr></table></figure>
<h1 id="Examplesfor-happybase"><a href="#Examplesfor-happybase" class="headerlink" title="Examplesfor happybase"></a>Examplesfor happybase</h1><h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> happybase</div><div class="line">connection = happybase.Connection(<span class="string">'localhost'</span>,table_prefix=<span class="string">'namespace'</span>)</div><div class="line"><span class="comment"># Starting with HBase 0.94, the Thrift server optionally uses a framed transport.</span></div><div class="line"><span class="comment"># table_prefix is similar to namespace</span></div><div class="line">connection.create_table(<span class="string">'data'</span>,&#123;<span class="string">'p'</span>:dict()&#125;,)</div><div class="line">connection.tables()</div><div class="line"></div><div class="line">table = connection.table(<span class="string">'data'</span>)</div><div class="line"></div><div class="line"><span class="comment"># input one row</span></div><div class="line">table.put(<span class="string">'o'</span>, &#123;<span class="string">'p:label'</span>: <span class="string">'0'</span>, <span class="string">'p:version'</span>: <span class="string">'201701'</span>, <span class="string">'p:weight'</span>: <span class="string">'0.4'</span>&#125;)</div><div class="line"></div><div class="line"><span class="comment"># input rows</span></div><div class="line"><span class="keyword">with</span> table.batch() <span class="keyword">as</span> bat:</div><div class="line">    bat.put(<span class="string">'1'</span>,&#123;<span class="string">'p:label'</span>: <span class="string">'1'</span>, <span class="string">'p:version'</span>: <span class="string">'201702'</span>, <span class="string">'p:weight'</span>: <span class="string">'0.5'</span>&#125;)</div><div class="line">    bat.put(<span class="string">'2'</span>,&#123;<span class="string">'p:label'</span>: <span class="string">'2'</span>, <span class="string">'p:version'</span>: <span class="string">'201703'</span>, <span class="string">'p:weight'</span>: <span class="string">'0.6'</span>&#125;)</div><div class="line"></div><div class="line"><span class="comment"># scan datas stored by batch with timestamp</span></div><div class="line">scan(row=<span class="string">'2'</span>,timestamnp=<span class="number">201704</span>) <span class="comment">#must larger than stored timestamp</span></div><div class="line"></div><div class="line"><span class="comment"># scan whole table</span></div><div class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> table.scan():</div><div class="line">    <span class="keyword">print</span> key, value</div><div class="line"></div><div class="line"><span class="comment"># scan with timestamp</span></div><div class="line">table.put(<span class="string">'2'</span>, &#123;<span class="string">'p:label'</span>: <span class="string">'233'</span>, <span class="string">'p:version'</span>: <span class="string">'2017234'</span>, <span class="string">'p:weight'</span>: <span class="string">'0.9'</span>&#125;,timestamp=<span class="number">201704</span>)</div><div class="line">table.row(<span class="string">'2'</span>,timestamp=<span class="number">201704</span>)</div><div class="line"></div><div class="line"><span class="comment"># enable and disable tables</span></div><div class="line">connection.enable_table(<span class="string">'data'</span>)</div><div class="line">connection.disable_table(<span class="string">'data'</span>)</div><div class="line"></div><div class="line"><span class="comment"># delete table</span></div><div class="line">connection.delete_table(<span class="string">'data'</span>)</div></pre></td></tr></table></figure>
<p>##Problems need to solve</p>
<h4 id="Connect-again"><a href="#Connect-again" class="headerlink" title="Connect again"></a>Connect again</h4><p>Need to coonect again after error or don’t use after second<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">connection = happybase.Connection(<span class="string">'localhost'</span>)</div><div class="line">table = connection.table(<span class="string">'namespace_data'</span>)</div></pre></td></tr></table></figure></p>
<h3 id="TTransportException"><a href="#TTransportException" class="headerlink" title="TTransportException"></a>TTransportException</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">/usr/local/lib/python2.7/site-packages/thriftpy/transport/socket.pyc in read(self, sz)</div><div class="line">    123         if len(buff) == 0:</div><div class="line">    124             raise TTransportException(type=TTransportException.END_OF_FILE,</div><div class="line">--&gt; 125                                       message='TSocket read 0 bytes')</div><div class="line">    126         return buff</div><div class="line">    127</div><div class="line"></div><div class="line">TTransportException: TTransportException(message='TSocket read 0 bytes', type=4)</div></pre></td></tr></table></figure>
<h3 id="Broken-pipe"><a href="#Broken-pipe" class="headerlink" title="Broken pipe"></a>Broken pipe</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">/usr/local/Cellar/python/2.7.13/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.pyc in meth(name, self, *args)</div><div class="line">    226</div><div class="line">    227 def meth(name,self,*args):</div><div class="line">--&gt; 228     return getattr(self._sock,name)(*args)</div><div class="line">    229</div><div class="line">    230 for _m in _socketmethods:</div><div class="line"></div><div class="line">error: [Errno 32] Broken pipe</div></pre></td></tr></table></figure>
<h3 id="Thrift-closed"><a href="#Thrift-closed" class="headerlink" title="Thrift closed"></a>Thrift closed</h3><p>thrift closed selfly after one hour, need to config it.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">2017-04-10 09:38:31,614 INFO  [main] util.VersionInfo: HBase 1.2.2</div><div class="line">2017-04-10 09:38:31,615 INFO  [main] util.VersionInfo: Source code repository git://asf-dev/home/busbey/projects/hbase revision=3f671c1ead70d249ea4598f1bbcc5151322b3a13</div><div class="line">2017-04-10 09:38:31,615 INFO  [main] util.VersionInfo: Compiled by busbey on Fri Jul  1 08:28:55 CDT 2016</div><div class="line">2017-04-10 09:38:31,615 INFO  [main] util.VersionInfo: From source with checksum 7ac43c3d2f62f134b2a6aa1a05ad66ac</div><div class="line">2017-04-10 09:38:31,888 INFO  [main] thrift.ThriftServerRunner: Using default thrift server type</div><div class="line">2017-04-10 09:38:31,888 INFO  [main] thrift.ThriftServerRunner: Using thrift server type threadpool</div><div class="line">2017-04-10 09:38:31,920 WARN  [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</div><div class="line"></div><div class="line"></div><div class="line">2017-04-10 10:38:32,580 INFO  [ConnectionCache_ChoreService_1] client.ConnectionManager$HConnectionImplementation: Closing master protocol: MasterService</div><div class="line">2017-04-10 10:38:32,581 INFO  [ConnectionCache_ChoreService_1] client.ConnectionManager$HConnectionImplementation: Closing zookeeper sessionid=0x15b558148f70006</div><div class="line">2017-04-10 10:38:32,588 INFO  [ConnectionCache_ChoreService_1] zookeeper.ZooKeeper: Session: 0x15b558148f70006 closed</div><div class="line">2017-04-10 10:38:32,588 INFO  [thrift-worker-2-EventThread] zookeeper.ClientCnxn: EventThread shut down</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">152</span>]: table.row(<span class="string">'66613341731'</span>,include_timestamp=<span class="keyword">True</span>)</div><div class="line">Out[<span class="number">152</span>]: &#123;<span class="string">'p:1'</span>: (<span class="string">'0.13'</span>, <span class="number">2017</span>)&#125;</div><div class="line"></div><div class="line">In [<span class="number">156</span>]: table.row(<span class="string">'66613341731'</span>,timestamp=<span class="number">2018</span>, include_timestamp=<span class="keyword">True</span>)</div><div class="line">Out[<span class="number">156</span>]: &#123;<span class="string">'p:1'</span>: (<span class="string">'0.13'</span>, <span class="number">2017</span>)&#125;</div><div class="line"></div><div class="line">In [<span class="number">157</span>]: table.row(<span class="string">'66613341731'</span>,timestamp=<span class="number">2017</span>, include_timestamp=<span class="keyword">True</span>)</div><div class="line">Out[<span class="number">157</span>]: &#123;&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/03/27/Tracking user with browser fingerprint/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/27/Tracking user with browser fingerprint/" itemprop="url">Tracking user with browser' fingerprint</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-27T20:47:24+08:00">
                2017-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Single-browser"><a href="#Single-browser" class="headerlink" title="Single-browser"></a>Single-browser</h2><h3 id="state-of-the-art"><a href="#state-of-the-art" class="headerlink" title="state of the art"></a>state of the art</h3><h4 id="Paper"><a href="#Paper" class="headerlink" title="Paper"></a>Paper</h4><blockquote>
<p><a href="https://hal.inria.fr/hal-01285470/file/beauty-sp16.pdf" target="_blank" rel="external">Beauty and the Beast: Diverting modern web browsers to build unique browser fingerprints</a></p>
</blockquote>
<h4 id="Website"><a href="#Website" class="headerlink" title="Website"></a>Website</h4><blockquote>
<p><a href="https://amiunique.org/" target="_blank" rel="external">AmIUnique</a></p>
</blockquote>
<h4 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h4><table>
<thead>
<tr>
<th style="text-align:left">Attribute</th>
<th style="text-align:center">Source</th>
<th style="text-align:right">Function or Example</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">User agent</td>
<td style="text-align:center">HTTP header</td>
<td style="text-align:right">“Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36”</td>
</tr>
<tr>
<td style="text-align:left">Accept</td>
<td style="text-align:center">HTTP header</td>
<td style="text-align:right">“text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8””text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8”</td>
</tr>
<tr>
<td style="text-align:left">Content encoding</td>
<td style="text-align:center">HTTP header</td>
<td style="text-align:right">“gzip, deflate, sdch, br”</td>
</tr>
<tr>
<td style="text-align:left">Content language</td>
<td style="text-align:center">HTTP header</td>
<td style="text-align:right">“en-US,en;q=0.8”</td>
</tr>
<tr>
<td style="text-align:left">List of plugins</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">navigator.plugins</td>
</tr>
<tr>
<td style="text-align:left">Platform</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">navigator.platform</td>
</tr>
<tr>
<td style="text-align:left">Cookies enabled</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">navigator.cookieEnabled</td>
</tr>
<tr>
<td style="text-align:left">Do not track</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">navigator.doNotTrack</td>
</tr>
<tr>
<td style="text-align:left">Timezone</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">new Date().getTimezoneOffset()</td>
</tr>
<tr>
<td style="text-align:left">Screen resolution and depth</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">screen.width/height/colordepth</td>
</tr>
<tr>
<td style="text-align:left">Use of local/session storage</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">localStorage/sessionStorage</td>
</tr>
<tr>
<td style="text-align:left"><strong>Canvas</strong></td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:left">WebGL Vendor</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">canvas.getContext(“…”)<sup>code 1</sup></td>
</tr>
<tr>
<td style="text-align:left">WebGL Render</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right">canvas.getContext(“…”)<sup>code 1</sup></td>
</tr>
<tr>
<td style="text-align:left">Use of Adblock</td>
<td style="text-align:center">JavaScript</td>
<td style="text-align:right"><a href="http://www.detectadblock.com/" target="_blank" rel="external">Detect Adblock</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>List of fonts</strong></td>
<td style="text-align:center">Sinde-channel</td>
<td style="text-align:right"><a href="https://seclab.cs.ucsb.edu/media/uploads/papers/sp2013_cookieless.pdf" target="_blank" rel="external">List 1 in Cookieless Monster<sup>code 2</sup></a></td>
</tr>
<tr>
<td style="text-align:left"><em>List of fonts</em></td>
<td style="text-align:center">Flash</td>
<td style="text-align:right">flash.text.Font.enumerateFonts(true)</td>
</tr>
<tr>
<td style="text-align:left"><em>Screen resolution</em></td>
<td style="text-align:center">Flash</td>
<td style="text-align:right">flash.system.Capabilities.screenResolutionX/Y</td>
</tr>
<tr>
<td style="text-align:left"><em>Platform</em></td>
<td style="text-align:center">Flash</td>
<td style="text-align:right">flash.system.Capabilities.os</td>
</tr>
<tr>
<td style="text-align:left"><em>Language</em></td>
<td style="text-align:center">Flash</td>
<td style="text-align:right">flash.system.Capabilities.language</td>
</tr>
</tbody>
</table>
<blockquote>
<p>code 1<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ctx = canvas.getContext(<span class="string">"webgl"</span>) || canvas.getContext(<span class="string">"experimental-webgl"</span>);</div><div class="line"><span class="keyword">if</span>(ctx.getSupportedExtensions().indexOf(<span class="string">"WEBGL_debug_renderer_info"</span>) &gt;= <span class="number">0</span>) &#123;</div><div class="line">    webGLVendor = ctx.getParameter(ctx.getExtension(<span class="string">'WEBGL_debug_renderer_info'</span>).UNMASKED_VENDOR_WEBGL);</div><div class="line">    webGLRenderer = ctx.getParameter(ctx.getExtension(<span class="string">'WEBGL_debug_renderer_info'</span>).UNMASKED_RENDERER_WEBGL);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    webGLVendor = <span class="string">"Not supported"</span>;</div><div class="line">    webGLRenderer = <span class="string">"Not supported"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>code 2<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_text_dimensions</span>(<span class="params">font</span>)</span>&#123;</div><div class="line">  h = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"BODY"</span>)[<span class="number">0</span>];</div><div class="line">  d = <span class="built_in">document</span>.createElement(<span class="string">"DIV"</span>);</div><div class="line">  s = <span class="built_in">document</span>.createElement(<span class="string">"SPAN"</span>);</div><div class="line">  d.appendChild(s);</div><div class="line">  d.style.fontFamily = font;</div><div class="line">  s.style.fontFamily = font;</div><div class="line">  s.style.fontSize = <span class="string">"72px"</span>;</div><div class="line">  s.innerHTML = <span class="string">"font_detection"</span>;</div><div class="line">  h.appendChild(d);</div><div class="line">  textWidth = s.offsetWidth;</div><div class="line">  textHeight = s.offsetHeight;</div><div class="line">  h.removeChild(d);</div><div class="line">  <span class="keyword">return</span> [textWidth, textHeight];</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="How-to-detect-a-specific-Chrome-extension-is-installed-from-regular-HTML-page"><a href="#How-to-detect-a-specific-Chrome-extension-is-installed-from-regular-HTML-page" class="headerlink" title="How to detect a specific Chrome extension is installed from regular HTML page"></a>How to detect a specific Chrome extension is installed from regular HTML page</h4><p>Each submitted extension on Chrome store has a special number.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">detectExtension</span>(<span class="params">extensionId, callback</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> img;</div><div class="line">    img = <span class="keyword">new</span> Image();</div><div class="line">    img.src = <span class="string">"chrome-extension://"</span> + extensionId + <span class="string">"/resources/icon_16.png"</span>;</div><div class="line">    img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        callback(<span class="literal">true</span>);</div><div class="line">    &#125;;</div><div class="line">    img.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        callback(<span class="literal">false</span>);</div><div class="line">    &#125;;</div></pre></td></tr></table></figure></p>
<h2 id="Cross-browser"><a href="#Cross-browser" class="headerlink" title="Cross-browser"></a>Cross-browser</h2><h4 id="Paper-1"><a href="#Paper-1" class="headerlink" title="Paper"></a>Paper</h4><p><a href="http://yinzhicao.org/TrackingFree/crossbrowsertracking_NDSS17.pdf" target="_blank" rel="external">(Cross-)Browser Fingerprinting via OS and Hardware Level Features</a></p>
<h4 id="Website-1"><a href="#Website-1" class="headerlink" title="Website"></a>Website</h4><p><a href="http://uniquemachine.org/index.html" target="_blank" rel="external">UNIQUEMACHINE</a></p>
<h4 id="Weakness"><a href="#Weakness" class="headerlink" title="Weakness"></a>Weakness</h4><ul>
<li>Small size of the training data<br>Only 3,615 fingerprints from 1,903 users within three months.</li>
<li>WebGL tasks need a significant time overhead.</li>
</ul>
<h4 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h4><ul>
<li>AmIUnique considered WebGL is “too brittle and unreliable”. Because they select a random WebGL task and does not restrict many variables, such as texture, transparency, light, canvas size and anti-aliasing.</li>
<li>Some differences between rendering results are very subtle, i.e., with one or two pixel variance.</li>
<li>WebGL rendering is a combination of software and hardware in which the hardware contributes more than the software. The uniqueness of software rendering is definitely much lower than the one of hardware rendering but still not zero.</li>
</ul>
<h4 id="Features-1"><a href="#Features-1" class="headerlink" title="Features"></a>Features</h4><h5 id="Screen-resolution"><a href="#Screen-resolution" class="headerlink" title="Screen resolution"></a>Screen resolution</h5><ul>
<li><strong>problem:</strong> The resolution changes in Firefox and IE when the user zooms in or out the web page.</li>
<li><strong>method:</strong><ul>
<li>Detect the zoom levels based on the size of a div tag and the device pixel ratio, and then adjust the screen resolution correspondingly.</li>
<li>The ratio between screen width and height, which does not change with the zoom level.</li>
</ul>
</li>
<li><strong>addition:</strong><ul>
<li>availHeight, availWidth, availLeft, availTop, and screenOrientation.</li>
<li>Users may open different browser in  different screens which have different resolutions.</li>
</ul>
</li>
</ul>
<h5 id="Number-of-CPU-virtual-cores"><a href="#Number-of-CPU-virtual-cores" class="headerlink" title="Number of CPU virtual cores"></a>Number of CPU virtual cores</h5><ul>
<li><strong>method:</strong> navigator.hardwareConcurrency</li>
<li><strong>addition:</strong> Safari will cut the number available cores to Web Workers by half.</li>
</ul>
<h5 id="AudioContext"><a href="#AudioContext" class="headerlink" title="AudioContext"></a>AudioContext</h5><p>Peak values and their corresponding frequencies are relatively stable across browsers.</p>
<ul>
<li><strong>paper:</strong> <a href="http://randomwalker.info/publications/OpenWPM_1_million_site_tracking_measurement.pdf" target="_blank" rel="external">Online Tracking:<br>A 1-million-site Measurement and Analysis</a></li>
<li><strong>problem:</strong> The entropy is much smaller than the entire entropy of the entire wave.</li>
</ul>
<h5 id="List-of-fonts"><a href="#List-of-fonts" class="headerlink" title="List of fonts"></a>List of fonts</h5><ul>
<li><strong>problem:</strong> Not all fonts are cross-browser fingerprintable because some fonts are web specific and provided by browsers.</li>
</ul>
<h5 id="Line-curve-and-anti-aliasing"><a href="#Line-curve-and-anti-aliasing" class="headerlink" title="Line, curve and anti-aliasing"></a>Line, curve and anti-aliasing</h5><p>There are many existing algorithms for anti-aliasing, such as first-principles approach, signal processing approach, and mipmapping, which make anti-aliasing fingerprintable.</p>
<h5 id="Vertex-shader-and-fragment-shader"><a href="#Vertex-shader-and-fragment-shader" class="headerlink" title="Vertex shader and fragment shader"></a>Vertex shader and fragment shader</h5><p>Algorithm differs from one graphic card to another, making texture fingerprintable.</p>
<ul>
<li><strong>Varyings:</strong> Provide an interface between Vertex and Fragment Shader. The interpolation algorithm varies in different computer graphics cards.</li>
<li><strong>Textures:</strong> Give a setting of mapping between vertexes and texture, a fragment shader calculates the color of each pixel based on the texture.</li>
</ul>
<h5 id="Transparency-via-Alpha-Channel"><a href="#Transparency-via-Alpha-Channel" class="headerlink" title="Transparency via Alpha Channel"></a>Transparency via Alpha Channel</h5><p>Because some graphics cards adopt discrete alpha values, some jumps may be observed in the changes of transparency effects.</p>
<h5 id="Image-encoding-and-decoding"><a href="#Image-encoding-and-decoding" class="headerlink" title="Image encoding and decoding"></a>Image encoding and decoding</h5><p>Different algorithms may uncover different information during decompression. Both DataURL and JPEG formats are unstable across different browsers, because these formats are with loss and implemented differently in multiple browsers and the server side as well.</p>
<ul>
<li><strong>problem:</strong> a single-browser feature, and cannot be used for cross-browser</li>
</ul>
<h5 id="Installed-writing-scripts-languages"><a href="#Installed-writing-scripts-languages" class="headerlink" title="Installed writing scripts (languages)"></a>Installed writing scripts (languages)</h5><p>A browser with a particular language installed will display the language correctly, and otherwise show several boxes.</p>
<h4 id="WebGL-tasks"><a href="#WebGL-tasks" class="headerlink" title="WebGL tasks"></a>WebGL tasks</h4><p>The size of the canvas is 256×256. The axes of the canvas are defined as follows. [0, 0, 0] is the middle of the canvas, where x-axis is the horizontal line that increases to the right, y-axis is the vertical line that increases to the bottom, and z-axis increases when moving far from the screen. An ambient light with the power of [R: 0.3, G: 0.3, B: 0.3] on a scale of 1 is present, and a camera is placed at the location of [0, 0, -7].</p>
<ul>
<li><p>Task (a): Texture<br>Randomly-generated texture rather than a regular will have more fingerprintable features.</p>
</li>
<li><p>Task (b): Varyings</p>
</li>
<li><p>Task (b’) Anti-aliasing + Varyings</p>
</li>
<li><p>Task (c) Camera（缩小立方体，减少了差异）<br>Camera moved to a new location of [-1, -4, 10]</p>
</li>
<li><p>Task (d) Lines and curves</p>
</li>
<li><p>Task (d’) Anti-aliasing +Anti-aliasing + Lines and curves</p>
</li>
<li><p>Task (e) Multi-models<br>信息熵比Task a就大了0.01</p>
</li>
<li><p>Task (f) Light<br>a diffuse, point white light. The power of the light is 2 for each primary color, and the light source is located at [3.0, -4.0, -2.0].<br>模型是彩色的，单色光可能会减少一些细微的差异。光照太弱不能照亮模型，太强会让所有都变成白色。位置是随机的。<br>信息熵比Task a就大了一点点</p>
</li>
<li><p>Task (g) Light and models<br>the interaction of a single, diffuse, point light and two models, because one model may create a shadow on another when illuminated by a point light.<br>信息熵比Task f就大了一点点信息熵就大了0.03</p>
</li>
<li><p>Task (h) Specular Light<br>test the effects of a diffuse point light with another color and a specular point light on two models.<br>信息熵比Task e大了0.9（f比e大了0.01）</p>
</li>
<li><p>Task (h’) Anti-aliasing + Specular Light</p>
</li>
<li><p>Task (h”) Anti-aliasing + Specular Light + Rotation<br>信息熵减小，稳定性增加，转了一面，信息变少了</p>
</li>
<li><p>Task (i) Two Textures（差了，第一层纹理是精心挑选的）<br>Add another texture on the multi-models in Task e.</p>
</li>
<li><p>Task (j) Alpha</p>
<ul>
<li>many GPUs do not accept smaller steps</li>
<li>the Suzanne and sofa models are positioned so that they are partially overlapped<br>增加alpha的值，趋势是信息熵变大，但是有反反复复的回滚，原因是software rendering引起的</li>
</ul>
</li>
<li><p>Task (k) Complex lights<br>因为有5000多个模型，光的反射又互相影响，所以效果拔群</p>
</li>
<li><p>Task (k’) Anti-aliasing + Complex lights</p>
</li>
<li><p>Task (l) Clipping plane<br>贡献不大</p>
</li>
<li><p>Task (m) Cubemap texture + Fresnel effect<br>比较好，信息多cube map</p>
</li>
<li><p>Task (n) DDS textures<br>微软那一套，一些浏览器不支持</p>
</li>
<li><p>Task (o) PVR textures<br>只支持苹果设备</p>
</li>
<li><p>Task (p) Float textures<br>比较好，信息多depth</p>
</li>
<li><p>Task (q) Video (Animating Textures)<br>single-browser的效果好。decoding video is a combination of the browser, the driver, and sometimes the hardware as well.</p>
</li>
<li>Task (r) Writing Scripts</li>
</ul>
<h2 id="To-be-continued"><a href="#To-be-continued" class="headerlink" title="To be continued"></a>To be continued</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://wu-yuanyi.github.io/2017/03/27/Basic Principles of Information Protect/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuanyi Wu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/27/Basic Principles of Information Protect/" itemprop="url">Basic Principles of Information Protect</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-27T20:47:24+08:00">
                2017-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://web.mit.edu/Saltzer/www/publications/protection/Basic.html" target="_blank" rel="external">Basic Principles of Information Protect</a></p>
<p>An externally administered code of ethics or a lack of knowledge about computers adequately protects the stored information.<br>The protection mechanisms not only protect one user from another, they may also protect their own implementation.<br>A narrow view is dangerous. It is hard to prove that this negative requirement has been achieved</p>
<h2 id="Considerations-Surrounding-the-Study-of-Protection"><a href="#Considerations-Surrounding-the-Study-of-Protection" class="headerlink" title="Considerations Surrounding the Study of Protection"></a>Considerations Surrounding the Study of Protection</h2><h3 id="Examples-of-security-techniques-sometimes-applied-to-computer-systems-are-the-following"><a href="#Examples-of-security-techniques-sometimes-applied-to-computer-systems-are-the-following" class="headerlink" title="Examples of security techniques sometimes applied to computer systems are the following:"></a>Examples of security techniques sometimes applied to computer systems are the following:</h3><ul>
<li>labeling files with lists of authorized users,</li>
<li>verifying the identity of a prospective user by demanding a password,</li>
<li>shielding the computer to prevent interception and subsequent interpretation of electromagnetic radiation,</li>
<li>enciphering information sent over telephone lines,</li>
<li>locking the room containing the computer,</li>
<li>controlling who is allowed to make changes to the computer system (both its hardware and software),</li>
<li>using redundant circuits or programmed cross-checks that maintain security in the face of hardware or software failures,</li>
<li>certifying that the hardware and software are actually implemented as intended.</li>
</ul>
<h3 id="Functional-Levels-of-Information-Protection"><a href="#Functional-Levels-of-Information-Protection" class="headerlink" title="Functional Levels of Information Protection:"></a>Functional Levels of Information Protection:</h3><ul>
<li>unprotected system</li>
<li>before release<ul>
<li>all-or-nothing system</li>
<li>controlled sharing</li>
<li>user_programmed sharing controls</li>
</ul>
</li>
<li>after release<ul>
<li>putting strings on information</li>
</ul>
</li>
</ul>
<h3 id="Design-principles"><a href="#Design-principles" class="headerlink" title="Design principles"></a>Design principles</h3><ul>
<li>Economy of mechanism(simple and small)</li>
<li>faill-safe default(white list)</li>
<li>complete mediation</li>
<li>open design</li>
<li>separation of privilege</li>
<li>least privilege</li>
<li>least common mechanism</li>
<li>psychological acceptability</li>
<li>two further design principles<ul>
<li>work factor</li>
<li>compromise recording</li>
</ul>
</li>
</ul>
<h2 id="Technical-Underpinnings"><a href="#Technical-Underpinnings" class="headerlink" title="Technical Underpinnings"></a>Technical Underpinnings</h2><h3 id="development-plan"><a href="#development-plan" class="headerlink" title="development plan"></a>development plan</h3><ul>
<li>from the top down: a subject is coherent and self-contained</li>
<li>bottom-up: a topic still containing ad hoc strategies and competing world views</li>
</ul>
<h3 id="essentials-of-information-protection"><a href="#essentials-of-information-protection" class="headerlink" title="essentials of information protection"></a>essentials of information protection</h3><ul>
<li>protect</li>
<li>authenticate</li>
</ul>
<h3 id="an-isolated-virtual-machine"><a href="#an-isolated-virtual-machine" class="headerlink" title="an isolated virtual machine"></a>an isolated virtual machine</h3><ul>
<li>descriptor register</li>
<li>privileged bit</li>
<li>supervisor</li>
</ul>
<h3 id="authentication-mechanisms"><a href="#authentication-mechanisms" class="headerlink" title="authentication mechanisms"></a>authentication mechanisms</h3><ul>
<li>password<ul>
<li>easy to guess</li>
<li>exposed to be used</li>
</ul>
</li>
</ul>
<h3 id="shared-information"><a href="#shared-information" class="headerlink" title="shared information"></a>shared information</h3><ul>
<li>list-oriented(high-level)</li>
<li>ticket-oriented(low-level)</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <p class="site-author-name" itemprop="name">Yuanyi Wu</p>
            <p class="site-description motion-element" itemprop="description"></p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuanyi Wu</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a></div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">Theme &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
